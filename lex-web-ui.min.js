(()=>{var e={74880:(e,t,s)=>{"use strict";s.a(e,(async(e,n)=>{try{s.d(t,{A:()=>m});s(44114);var i=s(10352),o=s(24667),r=s(15156),a=s(99962),c=s(98213),l=s.n(c),u=s(99141),d=s.n(u),h=s(62071),p=s(96763),g=e([o]);o=(g.then?(await g)():g)[0];const m={name:"lex-web",data(){return{userNameValue:"",toolbarHeightClassSuffix:"md"}},components:{MinButton:i.A,ToolbarContainer:o.A,MessageList:r.A,InputContainer:a.A},computed:{initialSpeechInstruction(){return this.$store.state.config.lex.initialSpeechInstruction},textInputPlaceholder(){return this.$store.state.config.ui.textInputPlaceholder},toolbarColor(){return this.$store.state.config.ui.toolbarColor},toolbarTitle(){return this.$store.state.config.ui.toolbarTitle},toolbarLogo(){return this.$store.state.config.ui.toolbarLogo},toolbarStartLiveChatLabel(){return this.$store.state.config.ui.toolbarStartLiveChatLabel},toolbarStartLiveChatIcon(){return this.$store.state.config.ui.toolbarStartLiveChatIcon},toolbarEndLiveChatLabel(){return this.$store.state.config.ui.toolbarEndLiveChatLabel},toolbarEndLiveChatIcon(){return this.$store.state.config.ui.toolbarEndLiveChatIcon},isSFXOn(){return this.$store.state.isSFXOn},isUiMinimized(){return this.$store.state.isUiMinimized},hasButtons(){return this.$store.state.hasButtons},lexState(){return this.$store.state.lex},isMobile(){const e=900;return"navigator"in window&&navigator.maxTouchPoints>0&&"screen"in window&&(window.screen.height<e||window.screen.width<e)}},watch:{lexState(){this.$emit("updateLexState",this.lexState),this.setFocusIfEnabled()}},created(){this.isMobile||(document.documentElement.style.overflowY="hidden"),this.initConfig().then((()=>Promise.all([this.$store.dispatch("initCredentials",this.$lexWebUi.awsConfig.credentials),this.$store.dispatch("initRecorder"),this.$store.dispatch("initBotAudio",window.Audio?new Audio:null)]))).then((()=>{if(!this.$store.state||!this.$store.state.config)return Promise.reject(new Error("no config found"));const e=this.$store.state.config.region?this.$store.state.config.region:this.$store.state.config.cognito.region;if(!e)return Promise.reject(new Error("no region found in config or config.cognito"));const t=this.$store.state.config.cognito.poolId;if(!t)return Promise.reject(new Error("no cognito.poolId found in config"));const s=window.AWS&&window.AWS.Config?window.AWS.Config:h.Config,n=window.AWS&&window.AWS.CognitoIdentityCredentials?window.AWS.CognitoIdentityCredentials:h.CognitoIdentityCredentials,i=window.AWS&&window.AWS.LexRuntime?window.AWS.LexRuntime:l(),o=window.AWS&&window.AWS.LexRuntimeV2?window.AWS.LexRuntimeV2:d(),r=new n({IdentityPoolId:t},{region:e}),a=new s({region:e,credentials:r});this.$lexWebUi.lexRuntimeClient=new i(a),this.$lexWebUi.lexRuntimeV2Client=new o(a),p.log(`lexRuntimeV2Client : ${JSON.stringify(this.$lexWebUi.lexRuntimeV2Client)}`);const c=[this.$store.dispatch("initMessageList"),this.$store.dispatch("initPollyClient",this.$lexWebUi.pollyClient),this.$store.dispatch("initLexClient",{v1client:this.$lexWebUi.lexRuntimeClient,v2client:this.$lexWebUi.lexRuntimeV2Client})];return p.info("CONFIG : ",this.$store.state.config),this.$store.state&&this.$store.state.config&&this.$store.state.config.ui.enableLiveChat&&c.push(this.$store.dispatch("initLiveChat")),Promise.all(c)})).then((()=>{document.title=this.$store.state.config.ui.pageTitle})).then((()=>this.$store.state.isRunningEmbedded?this.$store.dispatch("sendMessageToParentWindow",{event:"ready"}):Promise.resolve())).then((()=>{!0===this.$store.state.config.ui.saveHistory&&this.$store.subscribe(((e,t)=>{sessionStorage.setItem("store",JSON.stringify(t))}))})).then((()=>{p.info("successfully initialized lex web ui version: ",this.$store.state.version),this.$store.state.config.iframe.shouldLoadIframeMinimized||(setTimeout((()=>this.$store.dispatch("sendInitialUtterance")),500),this.$store.commit("setInitialUtteranceSent",!0))})).catch((e=>{p.error("could not initialize application while mounting:",e)}))},beforeUnmount(){"undefined"!==typeof window&&window.removeEventListener("resize",this.onResize,{passive:!0})},mounted(){this.$store.state.isRunningEmbedded||(this.$store.dispatch("sendMessageToParentWindow",{event:"requestTokens"}),this.setFocusIfEnabled()),this.onResize(),window.addEventListener("resize",this.onResize,{passive:!0})},methods:{onResize(){const{innerWidth:e}=window;this.setToolbarHeigthClassSuffix(e)},setToolbarHeigthClassSuffix(e){this.$store.state.isRunningEmbedded?this.toolbarHeightClassSuffix="md":this.toolbarHeightClassSuffix=e<640?"sm":e>640&&e<960?"md":"lg"},toggleMinimizeUi(){return this.$store.dispatch("toggleIsUiMinimized")},loginConfirmed(e){this.$store.commit("setIsLoggedIn",!0),e.detail&&e.detail.data?this.$store.commit("setTokens",e.detail.data):e.data&&e.data.data&&this.$store.commit("setTokens",e.data.data)},logoutConfirmed(){this.$store.commit("setIsLoggedIn",!1),this.$store.commit("setTokens",{idtokenjwt:"",accesstokenjwt:"",refreshtoken:""})},handleRequestLogin(){p.info("request login"),this.$store.state.isRunningEmbedded,this.$store.dispatch("sendMessageToParentWindow",{event:"requestLogin"})},handleRequestLogout(){p.info("request logout"),this.$store.state.isRunningEmbedded,this.$store.dispatch("sendMessageToParentWindow",{event:"requestLogout"})},handleRequestLiveChat(){p.info("handleRequestLiveChat"),this.$store.dispatch("requestLiveChat")},handleEndLiveChat(){p.info("LexWeb: handleEndLiveChat");try{this.$store.dispatch("requestLiveChatEnd")}catch(e){p.error(`error requesting disconnect ${e}`),this.$store.dispatch("pushLiveChatMessage",{type:"agent",text:this.$store.state.config.connect.chatEndedMessage}),this.$store.dispatch("liveChatSessionEnded")}},messageHandler(e){const t=this.$store.state.config.ui.hideButtonMessageBubble?"button":"human";if(e.origin===this.$store.state.config.ui.parentOrigin)if(e.ports&&Array.isArray(e.ports)&&e.ports.length)switch(e.data.event){case"ping":p.info("pong - ping received from parent"),e.ports[0].postMessage({event:"resolve",type:e.data.event}),this.setFocusIfEnabled();break;case"parentReady":e.ports[0].postMessage({event:"resolve",type:e.data.event});break;case"toggleMinimizeUi":this.$store.dispatch("toggleIsUiMinimized").then((()=>e.ports[0].postMessage({event:"resolve",type:e.data.event})));break;case"postText":if(!e.data.message)return void e.ports[0].postMessage({event:"reject",type:e.data.event,error:"missing message field"});this.$store.dispatch("postTextMessage",{type:e.data.messageType?e.data.messageType:t,text:e.data.message}).then((()=>e.ports[0].postMessage({event:"resolve",type:e.data.event})));break;case"deleteSession":this.$store.dispatch("deleteSession").then((()=>e.ports[0].postMessage({event:"resolve",type:e.data.event})));break;case"startNewSession":this.$store.dispatch("startNewSession").then((()=>e.ports[0].postMessage({event:"resolve",type:e.data.event})));break;case"setSessionAttribute":p.log(`From LexWeb: ${JSON.stringify(e.data,null,2)}`),this.$store.dispatch("setSessionAttribute",{key:e.data.key,value:e.data.value}).then((()=>e.ports[0].postMessage({event:"resolve",type:e.data.event})));break;case"confirmLogin":this.loginConfirmed(e),this.userNameValue=this.userName();break;case"confirmLogout":this.logoutConfirmed();break;default:p.warn("unknown message in messageHandler",e);break}else p.warn("postMessage not sent over MessageChannel",e);else p.warn("ignoring event - invalid origin:",e.origin)},componentMessageHandler(e){switch(e.detail.event){case"confirmLogin":this.loginConfirmed(e),this.userNameValue=this.userName();break;case"confirmLogout":this.logoutConfirmed();break;case"ping":this.$store.dispatch("sendMessageToParentWindow",{event:"pong"});break;case"postText":this.$store.dispatch("postTextMessage",{type:"human",text:e.detail.message});break;case"replaceCreds":this.$store.dispatch("initCredentials",e.detail.creds);break;default:p.warn("unknown message in componentMessageHandler",e);break}},userName(){return this.$store.getters.userName()},logRunningMode(){this.$store.state.isRunningEmbedded?(p.info("running in embedded mode from URL: ",document.location.href),p.info("referrer (possible parent) URL: ",document.referrer),p.info("config parentOrigin:",this.$store.state.config.ui.parentOrigin),document.referrer.startsWith(this.$store.state.config.ui.parentOrigin)||p.warn("referrer origin: [%s] does not match configured parent origin: [%s]",document.referrer,this.$store.state.config.ui.parentOrigin)):p.info("running in standalone mode")},initConfig(){return"true"!==this.$store.state.config.urlQueryParams.lexWebUiEmbed?(document.addEventListener("lexwebuicomponent",this.componentMessageHandler,!1),this.$store.commit("setIsRunningEmbedded",!1),this.$store.commit("setAwsCredsProvider","cognito")):(window.addEventListener("message",this.messageHandler,!1),this.$store.commit("setIsRunningEmbedded",!0),this.$store.commit("setAwsCredsProvider","parentWindow")),this.$store.dispatch("initConfig",this.$lexWebUi.config).then((()=>this.$store.dispatch("getConfigFromParent"))).then((e=>Object.keys(e).length?this.$store.dispatch("initConfig",e):Promise.resolve())).then((()=>{this.setFocusIfEnabled(),this.logRunningMode()}))},setFocusIfEnabled(){this.$store.state.config.ui.directFocusToBotInput&&this.$refs.InputContainer.setInputTextFieldFocus()}}};n()}catch(m){n(m)}}))},52093:(e,t,s)=>{"use strict";s.a(e,(async(e,n)=>{try{s.d(t,{A:()=>r});s(44114),s(98992),s(3949);var i=s(51740),o=e([i]);i=(o.then?(await o)():o)[0];const r={name:"toolbar-container",data(){return{items:[{title:"Login",icon:"login"},{title:"Logout",icon:"logout"},{title:"Clear Chat",icon:"delete"},{title:"Mute",icon:"volume_up"},{title:"Unmute",icon:"volume_off"}],shouldShowTooltip:!1,shouldShowHelpTooltip:!1,shouldShowMenuTooltip:!1,shouldShowEndLiveChatTooltip:!1,prevNav:!1,prevNavEventHandlers:{mouseenter:this.mouseOverPrev,mouseleave:this.mouseOverPrev,touchstart:this.mouseOverPrev,touchend:this.mouseOverPrev,touchcancel:this.mouseOverPrev},tooltipHelpEventHandlers:{mouseenter:this.onHelpButtonHoverEnter,mouseleave:this.onHelpButtonHoverLeave,touchstart:this.onHelpButtonHoverEnter,touchend:this.onHelpButtonHoverLeave,touchcancel:this.onHelpButtonHoverLeave},tooltipMenuEventHandlers:{mouseenter:this.onMenuButtonHoverEnter,mouseleave:this.onMenuButtonHoverLeave,touchstart:this.onMenuButtonHoverEnter,touchend:this.onMenuButtonHoverLeave,touchcancel:this.onMenuButtonHoverLeave},tooltipEventHandlers:{mouseenter:this.onInputButtonHoverEnter,mouseleave:this.onInputButtonHoverLeave,touchstart:this.onInputButtonHoverEnter,touchend:this.onInputButtonHoverLeave,touchcancel:this.onInputButtonHoverLeave},tooltipEndLiveChatEventHandlers:{mouseenter:this.onEndLiveChatButtonHoverEnter,mouseleave:this.onEndLiveChatButtonHoverLeave,touchstart:this.onEndLiveChatButtonHoverEnter,touchend:this.onEndLiveChatButtonHoverLeave,touchcancel:this.onEndLiveChatButtonHoverLeave}}},props:["toolbarTitle","toolbarColor","toolbarLogo","isUiMinimized","userName","toolbarStartLiveChatLabel","toolbarStartLiveChatIcon","toolbarEndLiveChatLabel","toolbarEndLiveChatIcon"],computed:{toolbarClickHandler(){return this.isUiMinimized?{click:this.toggleMinimize}:null},toolTipMinimize(){return this.isUiMinimized?"maximize":"minimize"},isEnableLogin(){return this.$store.state.config.ui.enableLogin},isForceLogin(){return this.$store.state.config.ui.forceLogin},hasPrevUtterance(){return this.$store.state.utteranceStack.length>1},isLoggedIn(){return this.$store.state.isLoggedIn},isSaveHistory(){return this.$store.state.config.ui.saveHistory},canLiveChat(){return this.$store.state.config.ui.enableLiveChat&&this.$store.state.chatMode===i.UD.BOT&&(this.$store.state.liveChat.status===i.nY.DISCONNECTED||this.$store.state.liveChat.status===i.nY.ENDED)},isLiveChat(){return this.$store.state.config.ui.enableLiveChat&&this.$store.state.chatMode===i.UD.LIVECHAT},isLocaleSelectable(){return this.$store.state.config.lex.v2BotLocaleId.split(",").length>1},restrictLocaleChanges(){return this.$store.state.lex.isProcessing||this.$store.state.lex.sessionState&&this.$store.state.lex.sessionState.dialogAction&&"ElicitSlot"===this.$store.state.lex.sessionState.dialogAction.type||this.$store.state.lex.sessionState&&this.$store.state.lex.sessionState.intent&&"InProgress"===this.$store.state.lex.sessionState.intent.state},currentLocale(){const e=localStorage.getItem("selectedLocale");return e&&this.setLocale(e),this.$store.state.config.lex.v2BotLocaleId.split(",")[0]},isLexProcessing(){return this.$store.state.isBackProcessing||this.$store.state.lex.isProcessing},shouldRenderHelpButton(){return!!this.$store.state.config.ui.helpIntent},shouldRenderSfxButton(){return this.$store.state.config.ui.enableSFX&&this.$store.state.config.ui.messageSentSFX&&this.$store.state.config.ui.messageReceivedSFX},shouldRenderBackButton(){return this.$store.state.config.ui.backButton},isSFXOn(){return this.$store.state.isSFXOn},density(){return this.$store.state.isRunningEmbedded&&!this.isUiMinimized?"compact":"default"},showToolbarMenu(){return this.$store.state.config.lex.v2BotLocaleId.split(",").length>1||this.$store.state.config.ui.enableLogin||this.$store.state.config.ui.saveHistory||this.$store.state.config.ui.shouldRenderSfxButton||this.$store.state.config.ui.enableLiveChat},locales(){const e=this.$store.state.config.lex.v2BotLocaleId.split(",");return e}},methods:{setLocale(e){const t=this.$store.state.config.lex.v2BotLocaleId.split(","),s=[];s.push(e),t.forEach((t=>{t!==e&&s.push(t)})),this.$store.commit("updateLocaleIds",s.toString()),localStorage.setItem("selectedLocale",e)},mouseOverPrev(){this.prevNav=!this.prevNav},onInputButtonHoverEnter(){this.shouldShowTooltip=!this.isUiMinimized},onInputButtonHoverLeave(){this.shouldShowTooltip=!1},onHelpButtonHoverEnter(){this.shouldShowHelpTooltip=!0},onHelpButtonHoverLeave(){this.shouldShowHelpTooltip=!1},onEndLiveChatButtonHoverEnter(){this.shouldShowEndLiveChatTooltip=!0},onEndLiveChatButtonHoverLeave(){this.shouldShowEndLiveChatTooltip=!1},onMenuButtonHoverEnter(){this.shouldShowMenuTooltip=!0},onMenuButtonHoverLeave(){this.shouldShowMenuTooltip=!1},onNavHoverEnter(){this.shouldShowNavToolTip=!0},onNavHoverLeave(){this.shouldShowNavToolTip=!1},toggleSFXMute(){this.onInputButtonHoverLeave(),this.$store.dispatch("toggleIsSFXOn")},toggleMinimize(){this.$store.state.isRunningEmbedded&&(this.onInputButtonHoverLeave(),this.$emit("toggleMinimizeUi"))},isValidHelpContentForUse(){const e=this.$store.state.config.lex.v2BotLocaleId?this.$store.state.config.lex.v2BotLocaleId:"en_US",t=this.$store.state.config.ui.helpContent;return t&&t[e]&&(t[e].text&&t[e].text.length>0||t[e].markdown&&t[e].markdown.length>0)},shouldRepeatLastMessage(){const e=this.$store.state.config.lex.v2BotLocaleId?this.$store.state.config.lex.v2BotLocaleId:"en_US",t=this.$store.state.config.ui.helpContent;return!(!t||!t[e]||void 0!==t[e].repeatLastMessage&&!t[e].repeatLastMessage)},messageForHelpContent(){const e=this.$store.state.config.lex.v2BotLocaleId?this.$store.state.config.lex.v2BotLocaleId:"en_US",t=this.$store.state.config.ui.helpContent;let s,n={};return t[e].markdown&&t[e].markdown.length>0&&(n.markdown=t[e].markdown),t[e].responseCard&&(s={version:1,contentType:"application/vnd.amazonaws.card.generic",genericAttachments:[{title:t[e].responseCard.title,subTitle:t[e].responseCard.subTitle,imageUrl:t[e].responseCard.imageUrl,attachmentLinkUrl:t[e].responseCard.attachmentLinkUrl,buttons:t[e].responseCard.buttons}]},n.markdown=t[e].markdown),{text:t[e].text,type:"bot",dialogState:"",responseCard:s,alts:n}},sendHelp(){if(this.isValidHelpContentForUse()){let e;this.$store.state.messages.length>0&&(e=this.$store.state.messages[this.$store.state.messages.length-1]),this.$store.dispatch("pushMessage",this.messageForHelpContent()),e&&this.shouldRepeatLastMessage()&&this.$store.dispatch("pushMessage",e)}else{const e={type:"human",text:this.$store.state.config.ui.helpIntent};this.$store.dispatch("postTextMessage",e)}this.shouldShowHelpTooltip=!1},onPrev(){if(this.prevNav&&this.mouseOverPrev(),!this.$store.state.isBackProcessing){this.$store.commit("popUtterance");const e=this.$store.getters.lastUtterance();if(e&&e.length>0){const t={type:"human",text:e};this.$store.commit("toggleBackProcessing"),this.$store.dispatch("postTextMessage",t)}}},requestLogin(){this.$emit("requestLogin")},requestLogout(){this.$emit("requestLogout")},requestResetHistory(){this.$store.dispatch("resetHistory")},requestLiveChat(){this.$emit("requestLiveChat")},endLiveChat(){this.shouldShowEndLiveChatTooltip=!1,this.$emit("endLiveChat")},toggleIsLoggedIn(){this.onInputButtonHoverLeave(),this.$emit("toggleIsLoggedIn")}}};n()}catch(r){n(r)}}))},34642:(e,t,s)=>{"use strict";s.a(e,(async(e,n)=>{try{s.d(t,{$:()=>v,R:()=>d});s(98992),s(81454),s(8872);var i=s(96763);const r=["dev","prod","test"].find((e=>"production".startsWith(e)));r||i.error("unknown environment in config: ","production");const a=await s(22857)(`./config.${r}.json`),c={region:"us-east-1",cognito:{poolId:""},connect:{contactFlowId:"",instanceId:"",apiGatewayEndpoint:"",promptForNameMessage:"Before starting a live chat, please tell me your name?",waitingForAgentMessage:"Thanks for waiting. An agent will be with you when available.",waitingForAgentMessageIntervalSeconds:60,liveChatTerms:"live chat",transcriptMessageDelayInMsec:150,endLiveChatUtterance:""},lex:{v2BotId:"",v2BotAliasId:"",v2BotLocaleId:"",botName:"WebUiOrderFlowers",botAlias:"$LATEST",initialText:'You can ask me for help ordering flowers. Just type "order flowers" or click on the mic and say it.',initialSpeechInstruction:'Say "Order Flowers" to get started',initialUtterance:"",sessionAttributes:{},reInitSessionAttributesOnRestart:!1,enablePlaybackInterrupt:!1,playbackInterruptVolumeThreshold:-60,playbackInterruptLevelThreshold:.0075,playbackInterruptNoiseThreshold:-75,playbackInterruptMinDuration:2,retryOnLexPostTextTimeout:!1,retryCountPostTextTimeout:1,allowStreamingResponses:!1,streamingWebSocketEndpoint:"",streamingDynamoDbTable:""},polly:{voiceId:"Joanna"},ui:{pageTitle:"Order Flowers Bot",parentOrigin:null,messageSentSFX:"send.mp3",messageReceivedSFX:"received.mp3",textInputPlaceholder:"Type here or click on the mic",minButtonContent:"",toolbarColor:"red",toolbarTitle:"Order Flowers",toolbarStartLiveChatLabel:"Start Live Chat",toolbarEndLiveChatLabel:"End Live Chat",toolbarStartLiveChatIcon:"people_alt",toolbarEndLiveChatIcon:"call_end",toolbarLogo:"",favIcon:"",pushInitialTextOnRestart:!0,reInitSessionAttributesOnRestart:!1,convertUrlToLinksInBotMessages:!0,stripTagsFromBotMessages:!0,showErrorDetails:!1,showMessageDate:!0,avatarImageUrl:"",agentAvatarImageUrl:"",showDialogStateIcon:!0,showCopyIcon:!1,hideButtonMessageBubble:!1,positiveFeedbackIntent:"",negativeFeedbackIntent:"",helpIntent:"",helpContent:{},showErrorIcon:!0,AllowSuperDangerousHTMLInMessage:!0,shouldDisplayResponseCardTitle:!0,shouldDisableClickedResponseCardButtons:!0,enableLogin:!1,enableSFX:!1,forceLogin:!1,directFocusToBotInput:!1,saveHistory:!1,enableLiveChat:!1,enableUpload:!1,uploadS3BucketName:"",uploadSuccessMessage:"",uploadFailureMessage:"Document upload failed",uploadRequireLogin:!0},recorder:{enable:!0,recordingTimeMax:10,recordingTimeMin:2.5,quietThreshold:.002,quietTimeMin:.3,volumeThreshold:-65,useAutoMuteDetect:!1,useBandPass:!1,encoderUseTrim:!1},converser:{silentConsecutiveRecordingMax:3},iframe:{shouldLoadIframeMinimized:!1},urlQueryParams:{}};function l(e){try{return e.split("?",2).slice(1,2).reduce(((e,t)=>t.split("&")),[]).map((e=>e.split("="))).reduce(((e,t)=>{const[s,n=!0]=t,i={[s]:decodeURIComponent(n)};return{...e,...i}}),{})}catch(t){return i.error("error obtaining URL query parameters",t),{}}}function u(e){try{return e.lexWebUiConfig?JSON.parse(e.lexWebUiConfig):{}}catch(t){return i.error("error parsing config from URL query",t),{}}}function d(e,t,s=!1){function n(e,t,s,n){return s in t?n&&"object"===typeof e[s]?{...d(t[s],e[s],n),...d(e[s],t[s],n)}:"object"===typeof e[s]?{...e[s],...t[s]}:t[s]:e[s]}return Object.keys(e).map((i=>{const o=n(e,t,i,s);return{[i]:o}})).reduce(((e,t)=>({...e,...t})),{})}i.log("configEnvFile ",a);const h=d(c,a),p=l(window.location.href),g=u(p);g.ui&&g.ui.parentOrigin&&delete g.ui.parentOrigin;const m=d(h,g),v={...m,urlQueryParams:p};n()}catch(o){n(o)}}),1)},13504:(e,t,s)=>{"use strict";s.a(e,(async(e,t)=>{try{var n=s(62071),i=s(98213),o=s.n(i),r=s(99141),a=s.n(r),c=s(57380),l=s.n(c),u=s(31934),d=s(55129),h=s(34642),p=s(20641),g=s(53751),m=(s(55283),s(2369)),v=s(66278),f=(s(35524),s(34825)),b=s(36037),y=s(33379),C=s(92162),A=s(96763),w=e([u,d,h]);[u,d,h]=w.then?(await w)():w;const x=window.Vue?window.Vue.defineAsyncComponent:p.$V,k={name:"lex-web-ui",template:"<lex-web></lex-web>",components:{LexWeb:u.A}},S={template:"<p>Loading. Please wait...</p>"},I={template:"<p>An error ocurred...</p>"},T=x({loader:()=>Promise.resolve(k),delay:200,timeout:1e4,errorComponent:I,loadingComponent:S}),M={install(e,{name:t="$lexWebUi",componentName:s="lex-web-ui",awsConfig:n,lexRuntimeClient:i,lexRuntimeV2Client:o,pollyClient:r,component:a=T,config:c=h.$}){const l={config:c,awsConfig:n,lexRuntimeClient:i,lexRuntimeV2Client:o,pollyClient:r};e.config.globalProperties[t]=l,e.component(s,a)}};class L{constructor(e={}){const t=window.Vue?window.Vue.createApp:g.createApp,s=window.Vuex?window.Vuex.createStore:v.y$,i=(0,f.$N)({components:b,directives:y,icons:{defaultSet:"md",aliases:m.z,sets:{md:m.md}},theme:{themes:{light:{colors:{primary:C.Ay.blue.darken2,secondary:C.Ay.grey.darken3,accent:C.Ay.blue.accent1,error:C.Ay.red.accent2,info:C.Ay.blue.base,success:C.Ay.green.base,warning:C.Ay.orange.darken1}},dark:{colors:{primary:C.Ay.blue.base,secondary:C.Ay.grey.darken3,accent:C.Ay.pink.accent1,error:C.Ay.red.accent2,info:C.Ay.blue.base,success:C.Ay.green.base,warning:C.Ay.orange.darken1}}}}}),r=t({template:'<div id="lex-web-ui"><lex-web-ui/></div>'});r.use(i);const c=s(d.A);this.store=c,r.use(c),this.app=r;const u=(0,h.R)(h.$,e),p=window.AWS&&window.AWS.Config?window.AWS.Config:n.Config,A=window.AWS&&window.AWS.CognitoIdentityCredentials?window.AWS.CognitoIdentityCredentials:n.CognitoIdentityCredentials,w=window.AWS&&window.AWS.Polly?window.AWS.Polly:l(),x=window.AWS&&window.AWS.LexRuntime?window.AWS.LexRuntime:o(),k=window.AWS&&window.AWS.LexRuntimeV2?window.AWS.LexRuntimeV2:a();if(!p||!A||!w||!x||!k)throw new Error("unable to find AWS SDK");const S=new A({IdentityPoolId:u.cognito.poolId},{region:u.region||u.cognito.poolId.split(":")[0]||"us-east-1"}),I=new p({region:u.region||u.cognito.poolId.split(":")[0]||"us-east-1",credentials:S}),T=new x(I),L=new k(I),E="undefined"===typeof u.recorder||u.recorder&&!1!==u.recorder.enable?new w(I):null;r.use(M,{config:u,awsConfig:I,lexRuntimeClient:T,lexRuntimeV2Client:L,pollyClient:E}),this.app=r}}A.log("Tjhis is called");const E=new L;E.app.mount("#lex-app"),t()}catch(x){t(x)}}))},71642:(e,t,s)=>{"use strict";s.d(t,{A:()=>u});var n=s(91114),i=(s(44114),s(98992),s(3949),s(48287)["Buffer"]),o=s(96763);const r=s(78559);function a(e){return JSON.parse(r.unzipSync(i.from(e,"base64")).toString("utf-8"))}function c(e){return r.unzipSync(i.from(e,"base64")).toString("utf-8").replaceAll('"',"")}function l(e){return r.gzipSync(i.from(JSON.stringify(e))).toString("base64")}const u=class{constructor({botName:e,botAlias:t="$LATEST",userId:s,lexRuntimeClient:i,botV2Id:r,botV2AliasId:a,botV2LocaleId:c,lexRuntimeV2Client:l}){if((0,n.A)(this,"botV2Id",void 0),(0,n.A)(this,"botV2AliasId",void 0),(0,n.A)(this,"botV2LocaleId",void 0),(0,n.A)(this,"isV2Bot",void 0),!e||!i||!l||"undefined"===typeof r||"undefined"===typeof a||"undefined"===typeof c)throw o.error(`botName: ${e} botV2Id: ${r} botV2AliasId ${a} botV2LocaleId ${c} lexRuntimeClient ${i} lexRuntimeV2Client ${l}`),new Error("invalid lex client constructor arguments");this.botName=e,this.botAlias=t,this.userId=s||`lex-web-ui-${Math.floor(65536*(1+Math.random())).toString(16).substring(1)}`,this.botV2Id=r,this.botV2AliasId=a,this.botV2LocaleId=c,this.isV2Bot=this.botV2Id.length>0,this.lexRuntimeClient=this.isV2Bot?l:i,this.credentials=this.lexRuntimeClient.config.credentials}initCredentials(e){this.credentials=e,this.lexRuntimeClient.config.credentials=this.credentials,this.userId=e.identityId?e.identityId:this.userId}deleteSession(){let e;return e=this.isV2Bot?this.lexRuntimeClient.deleteSession({botAliasId:this.botV2AliasId,botId:this.botV2Id,localeId:this.botV2LocaleId,sessionId:this.userId}):this.lexRuntimeClient.deleteSession({botAlias:this.botAlias,botName:this.botName,userId:this.userId}),this.credentials.getPromise().then((e=>e&&this.initCredentials(e))).then((()=>e.promise()))}startNewSession(){let e;return e=this.isV2Bot?this.lexRuntimeClient.putSession({botAliasId:this.botV2AliasId,botId:this.botV2Id,localeId:this.botV2LocaleId,sessionId:this.userId,sessionState:{dialogAction:{type:"ElicitIntent"}}}):this.lexRuntimeClient.putSession({botAlias:this.botAlias,botName:this.botName,userId:this.userId,dialogAction:{type:"ElicitIntent"}}),this.credentials.getPromise().then((e=>e&&this.initCredentials(e))).then((()=>e.promise()))}postText(e,t,s={}){let n;return n=this.isV2Bot?this.lexRuntimeClient.recognizeText({botAliasId:this.botV2AliasId,botId:this.botV2Id,localeId:t||"en_US",sessionId:this.userId,text:e,sessionState:{sessionAttributes:s}}):this.lexRuntimeClient.postText({botAlias:this.botAlias,botName:this.botName,userId:this.userId,inputText:e,sessionAttributes:s}),this.credentials.getPromise().then((e=>e&&this.initCredentials(e))).then((async()=>{const e=await n.promise();if(e.sessionState){e.sessionAttributes=e.sessionState.sessionAttributes,e.sessionState.intent?(e.intentName=e.sessionState.intent.name,e.slots=e.sessionState.intent.slots,e.dialogState=e.sessionState.intent.state,e.slotToElicit=e.sessionState.dialogAction.slotToElicit):(e.intentName=e.interpretations[0].intent.name,e.slots=e.interpretations[0].intent.slots,e.dialogState="",e.slotToElicit="");const t=[];if(e.messages&&e.messages.length>0&&e.messages.forEach((s=>{if("ImageResponseCard"===s.contentType){e.responseCardLexV2=e.responseCardLexV2?e.responseCardLexV2:[];const t={version:"1",contentType:"application/vnd.amazonaws.card.generic",genericAttachments:[]};t.genericAttachments.push(s.imageResponseCard),e.responseCardLexV2.push(t)}else if(s.contentType){const e={type:s.contentType,value:s.content,isLastMessageInGroup:"false"};t.push(e)}})),t.length>0){t[t.length-1].isLastMessageInGroup="true";const s=`{"messages": ${JSON.stringify(t)} }`;e.message=s}else{t.push({type:"PlainText",value:""});const s=`{"messages": ${JSON.stringify(t)} }`;e.message=s}}return e}))}postContent(e,t,s={},n="audio/ogg",i=0){const r=e.type;let u,d=r;if(r.startsWith("audio/wav")?d="audio/x-l16; sample-rate=16000; channel-count=1":r.startsWith("audio/ogg")?d=`audio/x-cbr-opus-with-preamble; bit-rate=32000; frame-size-milliseconds=20; preamble-size=${i}`:o.warn("unknown media type in lex client"),this.isV2Bot){const i={sessionAttributes:s};u=this.lexRuntimeClient.recognizeUtterance({botAliasId:this.botV2AliasId,botId:this.botV2Id,localeId:t||"en_US",sessionId:this.userId,responseContentType:n,requestContentType:d,inputStream:e,sessionState:l(i)})}else u=this.lexRuntimeClient.postContent({accept:n,botAlias:this.botAlias,botName:this.botName,userId:this.userId,contentType:d,inputStream:e,sessionAttributes:s});return this.credentials.getPromise().then((e=>e&&this.initCredentials(e))).then((async()=>{const e=await u.promise();if(e.sessionState){const t=a(e.sessionState);e.sessionAttributes=t.sessionAttributes?t.sessionAttributes:{},t.intent?(e.intentName=t.intent.name,e.slots=t.intent.slots,e.dialogState=t.intent.state,e.slotToElicit=t.dialogAction.slotToElicit):("interpretations"in t?(e.intentName=t.interpretations[0].intent.name,e.slots=t.interpretations[0].intent.slots):(e.intentName="",e.slots=""),e.dialogState="",e.slotToElicit=""),e.inputTranscript=e.inputTranscript&&c(e.inputTranscript),e.interpretations=e.interpretations&&a(e.interpretations),e.sessionState=t;const s=[];if(e.messages&&e.messages.length>0&&(e.messages=a(e.messages),e.responseCardLexV2=[],e.messages.forEach((t=>{if("ImageResponseCard"===t.contentType){e.responseCardLexV2=e.responseCardLexV2?e.responseCardLexV2:[];const s={version:"1",contentType:"application/vnd.amazonaws.card.generic",genericAttachments:[]};s.genericAttachments.push(t.imageResponseCard),e.responseCardLexV2.push(s)}else if(t.contentType){const e={type:t.contentType,value:t.content};s.push(e)}}))),s.length>0){const t=`{"messages": ${JSON.stringify(s)} }`;e.message=t}}return e}))}}},11998:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});s(16573),s(78100),s(77936),s(37467),s(44732),s(79577);var n=s(55512),i=s.n(n);function o(){return i()('(()=>{var t={9306:(t,r,e)=>{"use strict";var n=e(4901),o=e(6823),i=TypeError;t.exports=function(t){if(n(t))return t;throw new i(o(t)+" is not a function")}},3506:(t,r,e)=>{"use strict";var n=e(3925),o=String,i=TypeError;t.exports=function(t){if(n(t))return t;throw new i("Can\'t set "+o(t)+" as a prototype")}},8551:(t,r,e)=>{"use strict";var n=e(34),o=String,i=TypeError;t.exports=function(t){if(n(t))return t;throw new i(o(t)+" is not an object")}},7811:t=>{"use strict";t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},7394:(t,r,e)=>{"use strict";var n=e(4576),o=e(6706),i=e(2195),u=n.ArrayBuffer,s=n.TypeError;t.exports=u&&o(u.prototype,"byteLength","get")||function(t){if("ArrayBuffer"!==i(t))throw new s("ArrayBuffer expected");return t.byteLength}},3238:(t,r,e)=>{"use strict";var n=e(4576),o=e(7476),i=e(7394),u=n.ArrayBuffer,s=u&&u.prototype,c=s&&o(s.slice);t.exports=function(t){if(0!==i(t))return!1;if(!c)return!1;try{return c(t,0,0),!1}catch(r){return!0}}},5169:(t,r,e)=>{"use strict";var n=e(3238),o=TypeError;t.exports=function(t){if(n(t))throw new o("ArrayBuffer is detached");return t}},5636:(t,r,e)=>{"use strict";var n=e(4576),o=e(9504),i=e(6706),u=e(7696),s=e(5169),c=e(7394),a=e(4483),f=e(1548),p=n.structuredClone,y=n.ArrayBuffer,l=n.DataView,v=Math.min,h=y.prototype,g=l.prototype,d=o(h.slice),b=i(h,"resizable","get"),x=i(h,"maxByteLength","get"),w=o(g.getInt8),m=o(g.setInt8);t.exports=(f||a)&&function(t,r,e){var n,o=c(t),i=void 0===r?o:u(r),h=!b||!b(t);if(s(t),f&&(t=p(t,{transfer:[t]}),o===i&&(e||h)))return t;if(o>=i&&(!e||h))n=d(t,0,i);else{var g=e&&!h&&x?{maxByteLength:x(t)}:void 0;n=new y(i,g);for(var A=new l(t),O=new l(n),T=v(i,o),S=0;S<T;S++)m(O,S,w(A,S))}return f||a(t),n}},4644:(t,r,e)=>{"use strict";var n,o,i,u=e(7811),s=e(3724),c=e(4576),a=e(4901),f=e(34),p=e(9297),y=e(6955),l=e(6823),v=e(6699),h=e(6840),g=e(2106),d=e(1625),b=e(2787),x=e(2967),w=e(8227),m=e(3392),A=e(1181),O=A.enforce,T=A.get,S=c.Int8Array,j=S&&S.prototype,E=c.Uint8ClampedArray,B=E&&E.prototype,P=S&&b(S),C=j&&b(j),M=Object.prototype,_=c.TypeError,D=w("toStringTag"),I=m("TYPED_ARRAY_TAG"),U="TypedArrayConstructor",R=u&&!!x&&"Opera"!==y(c.opera),k=!1,F={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},L={BigInt64Array:8,BigUint64Array:8},N=function(t){if(!f(t))return!1;var r=y(t);return"DataView"===r||p(F,r)||p(L,r)},W=function(t){var r=b(t);if(f(r)){var e=T(r);return e&&p(e,U)?e[U]:W(r)}},z=function(t){if(!f(t))return!1;var r=y(t);return p(F,r)||p(L,r)},V=function(t){if(z(t))return t;throw new _("Target is not a typed array")},q=function(t){if(a(t)&&(!x||d(P,t)))return t;throw new _(l(t)+" is not a typed array constructor")},Y=function(t,r,e,n){if(s){if(e)for(var o in F){var i=c[o];if(i&&p(i.prototype,t))try{delete i.prototype[t]}catch(u){try{i.prototype[t]=r}catch(a){}}}C[t]&&!e||h(C,t,e?r:R&&j[t]||r,n)}},G=function(t,r,e){var n,o;if(s){if(x){if(e)for(n in F)if(o=c[n],o&&p(o,t))try{delete o[t]}catch(i){}if(P[t]&&!e)return;try{return h(P,t,e?r:R&&P[t]||r)}catch(i){}}for(n in F)o=c[n],!o||o[t]&&!e||h(o,t,r)}};for(n in F)o=c[n],i=o&&o.prototype,i?O(i)[U]=o:R=!1;for(n in L)o=c[n],i=o&&o.prototype,i&&(O(i)[U]=o);if((!R||!a(P)||P===Function.prototype)&&(P=function(){throw new _("Incorrect invocation")},R))for(n in F)c[n]&&x(c[n],P);if((!R||!C||C===M)&&(C=P.prototype,R))for(n in F)c[n]&&x(c[n].prototype,C);if(R&&b(B)!==C&&x(B,C),s&&!p(C,D))for(n in k=!0,g(C,D,{configurable:!0,get:function(){return f(this)?this[I]:void 0}}),F)c[n]&&v(c[n],I,n);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:R,TYPED_ARRAY_TAG:k&&I,aTypedArray:V,aTypedArrayConstructor:q,exportTypedArrayMethod:Y,exportTypedArrayStaticMethod:G,getTypedArrayConstructor:W,isView:N,isTypedArray:z,TypedArray:P,TypedArrayPrototype:C}},5370:(t,r,e)=>{"use strict";var n=e(6198);t.exports=function(t,r,e){var o=0,i=arguments.length>2?e:n(r),u=new t(i);while(i>o)u[o]=r[o++];return u}},9617:(t,r,e)=>{"use strict";var n=e(5397),o=e(5610),i=e(6198),u=function(t){return function(r,e,u){var s=n(r),c=i(s);if(0===c)return!t&&-1;var a,f=o(u,c);if(t&&e!==e){while(c>f)if(a=s[f++],a!==a)return!0}else for(;c>f;f++)if((t||f in s)&&s[f]===e)return t||f||0;return!t&&-1}};t.exports={includes:u(!0),indexOf:u(!1)}},4527:(t,r,e)=>{"use strict";var n=e(3724),o=e(4376),i=TypeError,u=Object.getOwnPropertyDescriptor,s=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=s?function(t,r){if(o(t)&&!u(t,"length").writable)throw new i("Cannot set read only .length");return t.length=r}:function(t,r){return t.length=r}},7628:(t,r,e)=>{"use strict";var n=e(6198);t.exports=function(t,r){for(var e=n(t),o=new r(e),i=0;i<e;i++)o[i]=t[e-i-1];return o}},9928:(t,r,e)=>{"use strict";var n=e(6198),o=e(1291),i=RangeError;t.exports=function(t,r,e,u){var s=n(t),c=o(e),a=c<0?s+c:c;if(a>=s||a<0)throw new i("Incorrect index");for(var f=new r(s),p=0;p<s;p++)f[p]=p===a?u:t[p];return f}},2195:(t,r,e)=>{"use strict";var n=e(9504),o=n({}.toString),i=n("".slice);t.exports=function(t){return i(o(t),8,-1)}},6955:(t,r,e)=>{"use strict";var n=e(2140),o=e(4901),i=e(2195),u=e(8227),s=u("toStringTag"),c=Object,a="Arguments"===i(function(){return arguments}()),f=function(t,r){try{return t[r]}catch(e){}};t.exports=n?i:function(t){var r,e,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=f(r=c(t),s))?e:a?i(r):"Object"===(n=i(r))&&o(r.callee)?"Arguments":n}},7740:(t,r,e)=>{"use strict";var n=e(9297),o=e(5031),i=e(7347),u=e(4913);t.exports=function(t,r,e){for(var s=o(r),c=u.f,a=i.f,f=0;f<s.length;f++){var p=s[f];n(t,p)||e&&n(e,p)||c(t,p,a(r,p))}}},2211:(t,r,e)=>{"use strict";var n=e(9039);t.exports=!n((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},6699:(t,r,e)=>{"use strict";var n=e(3724),o=e(4913),i=e(6980);t.exports=n?function(t,r,e){return o.f(t,r,i(1,e))}:function(t,r,e){return t[r]=e,t}},6980:t=>{"use strict";t.exports=function(t,r){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:r}}},2106:(t,r,e)=>{"use strict";var n=e(283),o=e(4913);t.exports=function(t,r,e){return e.get&&n(e.get,r,{getter:!0}),e.set&&n(e.set,r,{setter:!0}),o.f(t,r,e)}},6840:(t,r,e)=>{"use strict";var n=e(4901),o=e(4913),i=e(283),u=e(9433);t.exports=function(t,r,e,s){s||(s={});var c=s.enumerable,a=void 0!==s.name?s.name:r;if(n(e)&&i(e,a,s),s.global)c?t[r]=e:u(r,e);else{try{s.unsafe?t[r]&&(c=!0):delete t[r]}catch(f){}c?t[r]=e:o.f(t,r,{value:e,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return t}},9433:(t,r,e)=>{"use strict";var n=e(4576),o=Object.defineProperty;t.exports=function(t,r){try{o(n,t,{value:r,configurable:!0,writable:!0})}catch(e){n[t]=r}return r}},3724:(t,r,e)=>{"use strict";var n=e(9039);t.exports=!n((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4483:(t,r,e)=>{"use strict";var n,o,i,u,s=e(4576),c=e(9429),a=e(1548),f=s.structuredClone,p=s.ArrayBuffer,y=s.MessageChannel,l=!1;if(a)l=function(t){f(t,{transfer:[t]})};else if(p)try{y||(n=c("worker_threads"),n&&(y=n.MessageChannel)),y&&(o=new y,i=new p(2),u=function(t){o.port1.postMessage(null,[t])},2===i.byteLength&&(u(i),0===i.byteLength&&(l=u)))}catch(v){}t.exports=l},4055:(t,r,e)=>{"use strict";var n=e(4576),o=e(34),i=n.document,u=o(i)&&o(i.createElement);t.exports=function(t){return u?i.createElement(t):{}}},6837:t=>{"use strict";var r=TypeError,e=9007199254740991;t.exports=function(t){if(t>e)throw r("Maximum allowed index exceeded");return t}},8727:t=>{"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},6193:(t,r,e)=>{"use strict";var n=e(4215);t.exports="NODE"===n},2839:(t,r,e)=>{"use strict";var n=e(4576),o=n.navigator,i=o&&o.userAgent;t.exports=i?String(i):""},9519:(t,r,e)=>{"use strict";var n,o,i=e(4576),u=e(2839),s=i.process,c=i.Deno,a=s&&s.versions||c&&c.version,f=a&&a.v8;f&&(n=f.split("."),o=n[0]>0&&n[0]<4?1:+(n[0]+n[1])),!o&&u&&(n=u.match(/Edge\\/(\\d+)/),(!n||n[1]>=74)&&(n=u.match(/Chrome\\/(\\d+)/),n&&(o=+n[1]))),t.exports=o},4215:(t,r,e)=>{"use strict";var n=e(4576),o=e(2839),i=e(2195),u=function(t){return o.slice(0,t.length)===t};t.exports=function(){return u("Bun/")?"BUN":u("Cloudflare-Workers")?"CLOUDFLARE":u("Deno/")?"DENO":u("Node.js/")?"NODE":n.Bun&&"string"==typeof Bun.version?"BUN":n.Deno&&"object"==typeof Deno.version?"DENO":"process"===i(n.process)?"NODE":n.window&&n.document?"BROWSER":"REST"}()},6518:(t,r,e)=>{"use strict";var n=e(4576),o=e(7347).f,i=e(6699),u=e(6840),s=e(9433),c=e(7740),a=e(2796);t.exports=function(t,r){var e,f,p,y,l,v,h=t.target,g=t.global,d=t.stat;if(f=g?n:d?n[h]||s(h,{}):n[h]&&n[h].prototype,f)for(p in r){if(l=r[p],t.dontCallGetSet?(v=o(f,p),y=v&&v.value):y=f[p],e=a(g?p:h+(d?".":"#")+p,t.forced),!e&&void 0!==y){if(typeof l==typeof y)continue;c(l,y)}(t.sham||y&&y.sham)&&i(l,"sham",!0),u(f,p,l,t)}}},9039:t=>{"use strict";t.exports=function(t){try{return!!t()}catch(r){return!0}}},616:(t,r,e)=>{"use strict";var n=e(9039);t.exports=!n((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},9565:(t,r,e)=>{"use strict";var n=e(616),o=Function.prototype.call;t.exports=n?o.bind(o):function(){return o.apply(o,arguments)}},350:(t,r,e)=>{"use strict";var n=e(3724),o=e(9297),i=Function.prototype,u=n&&Object.getOwnPropertyDescriptor,s=o(i,"name"),c=s&&"something"===function(){}.name,a=s&&(!n||n&&u(i,"name").configurable);t.exports={EXISTS:s,PROPER:c,CONFIGURABLE:a}},6706:(t,r,e)=>{"use strict";var n=e(9504),o=e(9306);t.exports=function(t,r,e){try{return n(o(Object.getOwnPropertyDescriptor(t,r)[e]))}catch(i){}}},7476:(t,r,e)=>{"use strict";var n=e(2195),o=e(9504);t.exports=function(t){if("Function"===n(t))return o(t)}},9504:(t,r,e)=>{"use strict";var n=e(616),o=Function.prototype,i=o.call,u=n&&o.bind.bind(i,i);t.exports=n?u:function(t){return function(){return i.apply(t,arguments)}}},9429:(t,r,e)=>{"use strict";var n=e(4576),o=e(6193);t.exports=function(t){if(o){try{return n.process.getBuiltinModule(t)}catch(r){}try{return Function(\'return require("\'+t+\'")\')()}catch(r){}}}},7751:(t,r,e)=>{"use strict";var n=e(4576),o=e(4901),i=function(t){return o(t)?t:void 0};t.exports=function(t,r){return arguments.length<2?i(n[t]):n[t]&&n[t][r]}},5966:(t,r,e)=>{"use strict";var n=e(9306),o=e(4117);t.exports=function(t,r){var e=t[r];return o(e)?void 0:n(e)}},4576:function(t,r,e){"use strict";var n=function(t){return t&&t.Math===Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e.g&&e.g)||n("object"==typeof this&&this)||function(){return this}()||Function("return this")()},9297:(t,r,e)=>{"use strict";var n=e(9504),o=e(8981),i=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,r){return i(o(t),r)}},421:t=>{"use strict";t.exports={}},5917:(t,r,e)=>{"use strict";var n=e(3724),o=e(9039),i=e(4055);t.exports=!n&&!o((function(){return 7!==Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},7055:(t,r,e)=>{"use strict";var n=e(9504),o=e(9039),i=e(2195),u=Object,s=n("".split);t.exports=o((function(){return!u("z").propertyIsEnumerable(0)}))?function(t){return"String"===i(t)?s(t,""):u(t)}:u},3706:(t,r,e)=>{"use strict";var n=e(9504),o=e(4901),i=e(7629),u=n(Function.toString);o(i.inspectSource)||(i.inspectSource=function(t){return u(t)}),t.exports=i.inspectSource},1181:(t,r,e)=>{"use strict";var n,o,i,u=e(8622),s=e(4576),c=e(34),a=e(6699),f=e(9297),p=e(7629),y=e(6119),l=e(421),v="Object already initialized",h=s.TypeError,g=s.WeakMap,d=function(t){return i(t)?o(t):n(t,{})},b=function(t){return function(r){var e;if(!c(r)||(e=o(r)).type!==t)throw new h("Incompatible receiver, "+t+" required");return e}};if(u||p.state){var x=p.state||(p.state=new g);x.get=x.get,x.has=x.has,x.set=x.set,n=function(t,r){if(x.has(t))throw new h(v);return r.facade=t,x.set(t,r),r},o=function(t){return x.get(t)||{}},i=function(t){return x.has(t)}}else{var w=y("state");l[w]=!0,n=function(t,r){if(f(t,w))throw new h(v);return r.facade=t,a(t,w,r),r},o=function(t){return f(t,w)?t[w]:{}},i=function(t){return f(t,w)}}t.exports={set:n,get:o,has:i,enforce:d,getterFor:b}},4376:(t,r,e)=>{"use strict";var n=e(2195);t.exports=Array.isArray||function(t){return"Array"===n(t)}},1108:(t,r,e)=>{"use strict";var n=e(6955);t.exports=function(t){var r=n(t);return"BigInt64Array"===r||"BigUint64Array"===r}},4901:t=>{"use strict";var r="object"==typeof document&&document.all;t.exports="undefined"==typeof r&&void 0!==r?function(t){return"function"==typeof t||t===r}:function(t){return"function"==typeof t}},2796:(t,r,e)=>{"use strict";var n=e(9039),o=e(4901),i=/#|\\.prototype\\./,u=function(t,r){var e=c[s(t)];return e===f||e!==a&&(o(r)?n(r):!!r)},s=u.normalize=function(t){return String(t).replace(i,".").toLowerCase()},c=u.data={},a=u.NATIVE="N",f=u.POLYFILL="P";t.exports=u},4117:t=>{"use strict";t.exports=function(t){return null===t||void 0===t}},34:(t,r,e)=>{"use strict";var n=e(4901);t.exports=function(t){return"object"==typeof t?null!==t:n(t)}},3925:(t,r,e)=>{"use strict";var n=e(34);t.exports=function(t){return n(t)||null===t}},6395:t=>{"use strict";t.exports=!1},757:(t,r,e)=>{"use strict";var n=e(7751),o=e(4901),i=e(1625),u=e(7040),s=Object;t.exports=u?function(t){return"symbol"==typeof t}:function(t){var r=n("Symbol");return o(r)&&i(r.prototype,s(t))}},6198:(t,r,e)=>{"use strict";var n=e(8014);t.exports=function(t){return n(t.length)}},283:(t,r,e)=>{"use strict";var n=e(9504),o=e(9039),i=e(4901),u=e(9297),s=e(3724),c=e(350).CONFIGURABLE,a=e(3706),f=e(1181),p=f.enforce,y=f.get,l=String,v=Object.defineProperty,h=n("".slice),g=n("".replace),d=n([].join),b=s&&!o((function(){return 8!==v((function(){}),"length",{value:8}).length})),x=String(String).split("String"),w=t.exports=function(t,r,e){"Symbol("===h(l(r),0,7)&&(r="["+g(l(r),/^Symbol\\(([^)]*)\\).*$/,"$1")+"]"),e&&e.getter&&(r="get "+r),e&&e.setter&&(r="set "+r),(!u(t,"name")||c&&t.name!==r)&&(s?v(t,"name",{value:r,configurable:!0}):t.name=r),b&&e&&u(e,"arity")&&t.length!==e.arity&&v(t,"length",{value:e.arity});try{e&&u(e,"constructor")&&e.constructor?s&&v(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(o){}var n=p(t);return u(n,"source")||(n.source=d(x,"string"==typeof r?r:"")),t};Function.prototype.toString=w((function(){return i(this)&&y(this).source||a(this)}),"toString")},741:t=>{"use strict";var r=Math.ceil,e=Math.floor;t.exports=Math.trunc||function(t){var n=+t;return(n>0?e:r)(n)}},4913:(t,r,e)=>{"use strict";var n=e(3724),o=e(5917),i=e(8686),u=e(8551),s=e(6969),c=TypeError,a=Object.defineProperty,f=Object.getOwnPropertyDescriptor,p="enumerable",y="configurable",l="writable";r.f=n?i?function(t,r,e){if(u(t),r=s(r),u(e),"function"===typeof t&&"prototype"===r&&"value"in e&&l in e&&!e[l]){var n=f(t,r);n&&n[l]&&(t[r]=e.value,e={configurable:y in e?e[y]:n[y],enumerable:p in e?e[p]:n[p],writable:!1})}return a(t,r,e)}:a:function(t,r,e){if(u(t),r=s(r),u(e),o)try{return a(t,r,e)}catch(n){}if("get"in e||"set"in e)throw new c("Accessors not supported");return"value"in e&&(t[r]=e.value),t}},7347:(t,r,e)=>{"use strict";var n=e(3724),o=e(9565),i=e(8773),u=e(6980),s=e(5397),c=e(6969),a=e(9297),f=e(5917),p=Object.getOwnPropertyDescriptor;r.f=n?p:function(t,r){if(t=s(t),r=c(r),f)try{return p(t,r)}catch(e){}if(a(t,r))return u(!o(i.f,t,r),t[r])}},8480:(t,r,e)=>{"use strict";var n=e(1828),o=e(8727),i=o.concat("length","prototype");r.f=Object.getOwnPropertyNames||function(t){return n(t,i)}},3717:(t,r)=>{"use strict";r.f=Object.getOwnPropertySymbols},2787:(t,r,e)=>{"use strict";var n=e(9297),o=e(4901),i=e(8981),u=e(6119),s=e(2211),c=u("IE_PROTO"),a=Object,f=a.prototype;t.exports=s?a.getPrototypeOf:function(t){var r=i(t);if(n(r,c))return r[c];var e=r.constructor;return o(e)&&r instanceof e?e.prototype:r instanceof a?f:null}},1625:(t,r,e)=>{"use strict";var n=e(9504);t.exports=n({}.isPrototypeOf)},1828:(t,r,e)=>{"use strict";var n=e(9504),o=e(9297),i=e(5397),u=e(9617).indexOf,s=e(421),c=n([].push);t.exports=function(t,r){var e,n=i(t),a=0,f=[];for(e in n)!o(s,e)&&o(n,e)&&c(f,e);while(r.length>a)o(n,e=r[a++])&&(~u(f,e)||c(f,e));return f}},8773:(t,r)=>{"use strict";var e={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,o=n&&!e.call({1:2},1);r.f=o?function(t){var r=n(this,t);return!!r&&r.enumerable}:e},2967:(t,r,e)=>{"use strict";var n=e(6706),o=e(34),i=e(7750),u=e(3506);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,r=!1,e={};try{t=n(Object.prototype,"__proto__","set"),t(e,[]),r=e instanceof Array}catch(s){}return function(e,n){return i(e),u(n),o(e)?(r?t(e,n):e.__proto__=n,e):e}}():void 0)},4270:(t,r,e)=>{"use strict";var n=e(9565),o=e(4901),i=e(34),u=TypeError;t.exports=function(t,r){var e,s;if("string"===r&&o(e=t.toString)&&!i(s=n(e,t)))return s;if(o(e=t.valueOf)&&!i(s=n(e,t)))return s;if("string"!==r&&o(e=t.toString)&&!i(s=n(e,t)))return s;throw new u("Can\'t convert object to primitive value")}},5031:(t,r,e)=>{"use strict";var n=e(7751),o=e(9504),i=e(8480),u=e(3717),s=e(8551),c=o([].concat);t.exports=n("Reflect","ownKeys")||function(t){var r=i.f(s(t)),e=u.f;return e?c(r,e(t)):r}},7750:(t,r,e)=>{"use strict";var n=e(4117),o=TypeError;t.exports=function(t){if(n(t))throw new o("Can\'t call method on "+t);return t}},6119:(t,r,e)=>{"use strict";var n=e(5745),o=e(3392),i=n("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},7629:(t,r,e)=>{"use strict";var n=e(6395),o=e(4576),i=e(9433),u="__core-js_shared__",s=t.exports=o[u]||i(u,{});(s.versions||(s.versions=[])).push({version:"3.39.0",mode:n?"pure":"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"})},5745:(t,r,e)=>{"use strict";var n=e(7629);t.exports=function(t,r){return n[t]||(n[t]=r||{})}},1548:(t,r,e)=>{"use strict";var n=e(4576),o=e(9039),i=e(9519),u=e(4215),s=n.structuredClone;t.exports=!!s&&!o((function(){if("DENO"===u&&i>92||"NODE"===u&&i>94||"BROWSER"===u&&i>97)return!1;var t=new ArrayBuffer(8),r=s(t,{transfer:[t]});return 0!==t.byteLength||8!==r.byteLength}))},4495:(t,r,e)=>{"use strict";var n=e(9519),o=e(9039),i=e(4576),u=i.String;t.exports=!!Object.getOwnPropertySymbols&&!o((function(){var t=Symbol("symbol detection");return!u(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},5610:(t,r,e)=>{"use strict";var n=e(1291),o=Math.max,i=Math.min;t.exports=function(t,r){var e=n(t);return e<0?o(e+r,0):i(e,r)}},5854:(t,r,e)=>{"use strict";var n=e(2777),o=TypeError;t.exports=function(t){var r=n(t,"number");if("number"==typeof r)throw new o("Can\'t convert number to bigint");return BigInt(r)}},7696:(t,r,e)=>{"use strict";var n=e(1291),o=e(8014),i=RangeError;t.exports=function(t){if(void 0===t)return 0;var r=n(t),e=o(r);if(r!==e)throw new i("Wrong length or index");return e}},5397:(t,r,e)=>{"use strict";var n=e(7055),o=e(7750);t.exports=function(t){return n(o(t))}},1291:(t,r,e)=>{"use strict";var n=e(741);t.exports=function(t){var r=+t;return r!==r||0===r?0:n(r)}},8014:(t,r,e)=>{"use strict";var n=e(1291),o=Math.min;t.exports=function(t){var r=n(t);return r>0?o(r,9007199254740991):0}},8981:(t,r,e)=>{"use strict";var n=e(7750),o=Object;t.exports=function(t){return o(n(t))}},2777:(t,r,e)=>{"use strict";var n=e(9565),o=e(34),i=e(757),u=e(5966),s=e(4270),c=e(8227),a=TypeError,f=c("toPrimitive");t.exports=function(t,r){if(!o(t)||i(t))return t;var e,c=u(t,f);if(c){if(void 0===r&&(r="default"),e=n(c,t,r),!o(e)||i(e))return e;throw new a("Can\'t convert object to primitive value")}return void 0===r&&(r="number"),s(t,r)}},6969:(t,r,e)=>{"use strict";var n=e(2777),o=e(757);t.exports=function(t){var r=n(t,"string");return o(r)?r:r+""}},2140:(t,r,e)=>{"use strict";var n=e(8227),o=n("toStringTag"),i={};i[o]="z",t.exports="[object z]"===String(i)},6823:t=>{"use strict";var r=String;t.exports=function(t){try{return r(t)}catch(e){return"Object"}}},3392:(t,r,e)=>{"use strict";var n=e(9504),o=0,i=Math.random(),u=n(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+u(++o+i,36)}},7040:(t,r,e)=>{"use strict";var n=e(4495);t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},8686:(t,r,e)=>{"use strict";var n=e(3724),o=e(9039);t.exports=n&&o((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8622:(t,r,e)=>{"use strict";var n=e(4576),o=e(4901),i=n.WeakMap;t.exports=o(i)&&/native code/.test(String(i))},8227:(t,r,e)=>{"use strict";var n=e(4576),o=e(5745),i=e(9297),u=e(3392),s=e(4495),c=e(7040),a=n.Symbol,f=o("wks"),p=c?a["for"]||a:a&&a.withoutSetter||u;t.exports=function(t){return i(f,t)||(f[t]=s&&i(a,t)?a[t]:p("Symbol."+t)),f[t]}},6573:(t,r,e)=>{"use strict";var n=e(3724),o=e(2106),i=e(3238),u=ArrayBuffer.prototype;n&&!("detached"in u)&&o(u,"detached",{configurable:!0,get:function(){return i(this)}})},7936:(t,r,e)=>{"use strict";var n=e(6518),o=e(5636);o&&n({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return o(this,arguments.length?arguments[0]:void 0,!1)}})},8100:(t,r,e)=>{"use strict";var n=e(6518),o=e(5636);o&&n({target:"ArrayBuffer",proto:!0},{transfer:function(){return o(this,arguments.length?arguments[0]:void 0,!0)}})},4114:(t,r,e)=>{"use strict";var n=e(6518),o=e(8981),i=e(6198),u=e(4527),s=e(6837),c=e(9039),a=c((function(){return 4294967297!==[].push.call({length:4294967296},1)})),f=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},p=a||!f();n({target:"Array",proto:!0,arity:1,forced:p},{push:function(t){var r=o(this),e=i(r),n=arguments.length;s(e+n);for(var c=0;c<n;c++)r[e]=arguments[c],e++;return u(r,e),e}})},7467:(t,r,e)=>{"use strict";var n=e(7628),o=e(4644),i=o.aTypedArray,u=o.exportTypedArrayMethod,s=o.getTypedArrayConstructor;u("toReversed",(function(){return n(i(this),s(this))}))},4732:(t,r,e)=>{"use strict";var n=e(4644),o=e(9504),i=e(9306),u=e(5370),s=n.aTypedArray,c=n.getTypedArrayConstructor,a=n.exportTypedArrayMethod,f=o(n.TypedArrayPrototype.sort);a("toSorted",(function(t){void 0!==t&&i(t);var r=s(this),e=u(c(r),r);return f(e,t)}))},9577:(t,r,e)=>{"use strict";var n=e(9928),o=e(4644),i=e(1108),u=e(1291),s=e(5854),c=o.aTypedArray,a=o.getTypedArrayConstructor,f=o.exportTypedArrayMethod,p=!!function(){try{new Int8Array(1)["with"](2,{valueOf:function(){throw 8}})}catch(t){return 8===t}}();f("with",{with:function(t,r){var e=c(this),o=u(t),f=i(e)?s(r):+r;return n(e,a(e),o,f)}}["with"],!p)}},r={};function e(n){var o=r[n];if(void 0!==o)return o.exports;var i=r[n]={exports:{}};return t[n].call(i.exports,i,i.exports,e),i.exports}(()=>{e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()})();e(4114),e(6573),e(8100),e(7936),e(7467),e(4732),e(9577);const n=16,o=n/8,i=16e3,u=1;let s=0,c=[];const a={sampleRate:44e3,numChannels:1,useDownsample:!0,useTrim:!0,quietTrimThreshold:8e-4,quietTrimSlackBack:4e3};function f(t){Object.assign(a,t),h()}function p(t){for(let r=0;r<a.numChannels;r++)c[r].push(t[r]);s+=t[0].length}function y(t){const r=[];for(let i=0;i<a.numChannels;i++)r.push(g(c[i],s));let e;e=2===a.numChannels&&2===u?d(r[0],r[1]):r[0];const n=m(e,i),o=w(n),f=new Blob([o],{type:t});self.postMessage({command:"exportWAV",data:f})}function l(){const t=[];for(let r=0;r<a.numChannels;r++)t.push(g(c[r],s));self.postMessage({command:"getBuffer",data:t})}function v(){s=0,c=[],h()}function h(){for(let t=0;t<a.numChannels;t++)c[t]=[]}function g(t,r){const e=new Float32Array(r);let n=0;for(let o=0;o<t.length;o++)e.set(t[o],n),n+=t[o].length;return e}function d(t,r){const e=t.length+r.length,n=new Float32Array(e);let o=0,i=0;while(o<e)n[o++]=t[i],n[o++]=r[i],i++;return n}function b(t,r,e){for(let n=0,o=r;n<e.length;n++,o+=2){const r=Math.max(-1,Math.min(1,e[n]));t.setInt16(o,r<0?32768*r:32767*r,!0)}}function x(t,r){t.setUint32(0,1380533830,!1),t.setUint32(4,36+r,!0),t.setUint32(8,1463899717,!1),t.setUint32(12,1718449184,!1),t.setUint32(16,16,!0),t.setUint16(20,1,!0),t.setUint16(22,u,!0),t.setUint32(24,i,!0),t.setUint32(28,i*o*u,!0),t.setUint16(32,o*u,!0),t.setUint16(34,n,!0),t.setUint32(36,1684108385,!1)}function w(t){const r=new ArrayBuffer(44+2*t.length),e=new DataView(r);return x(e,t.length),b(e,44,t),e}function m(t,r){if(r===a.sampleRate)return t;const e=t.length,n=a.sampleRate/r,o=Math.round(e/n),i=new Float32Array(o);let u=0,s=0,c=0,f=e;while(u<i.length){const r=Math.round((u+1)*n);let o=0,p=0;for(let n=s;n<r&&n<e;n++)o+=t[n],p++;o>a.quietTrimThreshold&&(0===c&&(c=u),f=u),i[u]=o/p,u++,s=r}return a.useTrim?i.slice(Math.max(0,c-a.quietTrimSlackBack),Math.min(o,f+a.quietTrimSlackBack)):i}self.onmessage=t=>{switch(t.data.command){case"init":f(t.data.config);break;case"record":p(t.data.buffer);break;case"exportWav":y(t.data.type);break;case"getBuffer":l();break;case"clear":v();break;case"close":self.close();break;default:break}}})();',"Worker",void 0,s.p+"wav-worker.min.js")}var r=s(96763);const a=class{constructor(e={}){this.initOptions(e),this._eventTarget=document.createDocumentFragment(),this._encoderWorker=new o,this._encoderWorker.addEventListener("message",(e=>this._exportWav(e.data)))}initOptions(e={}){e.preset&&Object.assign(e,this._getPresetOptions(e.preset)),this.mimeType=e.mimeType||"audio/wav",this.recordingTimeMax=e.recordingTimeMax||8,this.recordingTimeMin=e.recordingTimeMin||2,this.recordingTimeMinAutoIncrease="undefined"===typeof e.recordingTimeMinAutoIncrease||!!e.recordingTimeMinAutoIncrease,this.autoStopRecording="undefined"===typeof e.autoStopRecording||!!e.autoStopRecording,this.quietThreshold=e.quietThreshold||.001,this.quietTimeMin=e.quietTimeMin||.4,this.volumeThreshold=e.volumeThreshold||-75,this.useBandPass="undefined"===typeof e.useBandPass||!!e.useBandPass,this.bandPassFrequency=e.bandPassFrequency||4e3,this.bandPassQ=e.bandPassQ||.707,this.bufferLength=e.bufferLength||2048,this.numChannels=e.numChannels||1,this.requestEchoCancellation="undefined"===typeof e.requestEchoCancellation||!!e.requestEchoCancellation,this.useAutoMuteDetect="undefined"===typeof e.useAutoMuteDetect||!!e.useAutoMuteDetect,this.muteThreshold=e.muteThreshold||1e-7,this.encoderUseTrim="undefined"===typeof e.encoderUseTrim||!!e.encoderUseTrim,this.encoderQuietTrimThreshold=e.encoderQuietTrimThreshold||8e-4,this.encoderQuietTrimSlackBack=e.encoderQuietTrimSlackBack||4e3}_getPresetOptions(e="low_latency"){if(this._presets=["low_latency","speech_recognition"],-1===this._presets.indexOf(e))return r.error("invalid preset"),{};const t={low_latency:{encoderUseTrim:!0,useBandPass:!0},speech_recognition:{encoderUseTrim:!1,useBandPass:!1,useAutoMuteDetect:!1}};return t[e]}init(){return this._state="inactive",this._instant=0,this._slow=0,this._clip=0,this._maxVolume=-1/0,this._isMicQuiet=!0,this._isMicMuted=!1,this._isSilentRecording=!0,this._silentRecordingConsecutiveCount=0,Promise.resolve()}async start(){if("inactive"!==this._state||"undefined"===typeof this._stream){if("inactive"!==this._state)return void r.warn("invalid state to start recording");if(r.warn("initializing audiocontext after first user interaction - chrome fix"),await this._initAudioContext().then((()=>this._initMicVolumeProcessor())).then((()=>this._initStream())),"undefined"===typeof this._stream)return void r.warn("failed to initialize audiocontext")}this._state="recording",this._recordingStartTime=this._audioContext.currentTime,this._eventTarget.dispatchEvent(new Event("start")),this._encoderWorker.postMessage({command:"init",config:{sampleRate:this._audioContext.sampleRate,numChannels:this.numChannels,useTrim:this.encoderUseTrim,quietTrimThreshold:this.encoderQuietTrimThreshold,quietTrimSlackBack:this.encoderQuietTrimSlackBack}})}stop(){"recording"===this._state?(this._recordingStartTime>this._quietStartTime?(this._isSilentRecording=!0,this._silentRecordingConsecutiveCount+=1,this._eventTarget.dispatchEvent(new Event("silentrecording"))):(this._isSilentRecording=!1,this._silentRecordingConsecutiveCount=0,this._eventTarget.dispatchEvent(new Event("unsilentrecording"))),this._state="inactive",this._recordingStartTime=0,this._encoderWorker.postMessage({command:"exportWav",type:"audio/wav"}),this._eventTarget.dispatchEvent(new Event("stop"))):r.warn("recorder stop called out of state")}_exportWav(e){const t=new CustomEvent("dataavailable",{detail:e.data});this._eventTarget.dispatchEvent(t),this._encoderWorker.postMessage({command:"clear"})}_recordBuffers(e){if("recording"!==this._state)return void r.warn("recorder _recordBuffers called out of state");const t=[];for(let s=0;s<e.numberOfChannels;s++)t[s]=e.getChannelData(s);this._encoderWorker.postMessage({command:"record",buffer:t})}_setIsMicMuted(){this.useAutoMuteDetect&&(this._instant>=this.muteThreshold?this._isMicMuted&&(this._isMicMuted=!1,this._eventTarget.dispatchEvent(new Event("unmute"))):!this._isMicMuted&&this._slow<this.muteThreshold&&(this._isMicMuted=!0,this._eventTarget.dispatchEvent(new Event("mute")),r.info("mute - instant: %s - slow: %s - track muted: %s",this._instant,this._slow,this._tracks[0].muted),"recording"===this._state&&(this.stop(),r.info("stopped recording on _setIsMicMuted"))))}_setIsMicQuiet(){const e=this._audioContext.currentTime,t=this._maxVolume<this.volumeThreshold||this._slow<this.quietThreshold;!this._isMicQuiet&&t&&(this._quietStartTime=this._audioContext.currentTime,this._eventTarget.dispatchEvent(new Event("quiet"))),this._isMicQuiet&&!t&&(this._quietStartTime=0,this._eventTarget.dispatchEvent(new Event("unquiet"))),this._isMicQuiet=t;const s=this.recordingTimeMinAutoIncrease?this.recordingTimeMin-1+this.recordingTimeMax**(1-1/(this._silentRecordingConsecutiveCount+1)):this.recordingTimeMin;this.autoStopRecording&&this._isMicQuiet&&"recording"===this._state&&e-this._recordingStartTime>s&&e-this._quietStartTime>this.quietTimeMin&&this.stop()}_initAudioContext(){return window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext?(this._audioContext=new AudioContext,document.addEventListener("visibilitychange",(()=>{r.info("visibility change triggered in recorder. hidden:",document.hidden),document.hidden?this._audioContext.suspend():this._audioContext.resume().then((()=>{r.info("Playback resumed successfully from visibility change")}))})),Promise.resolve()):Promise.reject(new Error("Web Audio API not supported."))}_initMicVolumeProcessor(){const e=this._audioContext.createScriptProcessor(this.bufferLength,this.numChannels,this.numChannels);return e.onaudioprocess=e=>{"recording"===this._state&&(this._recordBuffers(e.inputBuffer),this._audioContext.currentTime-this._recordingStartTime>this.recordingTimeMax&&(r.warn("stopped recording due to maximum time"),this.stop()));const t=e.inputBuffer.getChannelData(0);let s=0,n=0;for(let i=0;i<t.length;++i)s+=t[i]*t[i],Math.abs(t[i])>.99&&(n+=1);this._instant=Math.sqrt(s/t.length),this._slow=.95*this._slow+.05*this._instant,this._clip=t.length?n/t.length:0,this._setIsMicMuted(),this._setIsMicQuiet(),this._analyser.getFloatFrequencyData(this._analyserData),this._maxVolume=Math.max(...this._analyserData)},this._micVolumeProcessor=e,Promise.resolve()}_initStream(){const e={audio:{optional:[{echoCancellation:this.requestEchoCancellation}]}};return navigator.mediaDevices.getUserMedia(e).then((e=>{this._stream=e,this._tracks=e.getAudioTracks(),r.info("using media stream track labeled: ",this._tracks[0].label),this._tracks[0].onmute=this._setIsMicMuted,this._tracks[0].onunmute=this._setIsMicMuted;const t=this._audioContext.createMediaStreamSource(e),s=this._audioContext.createGain(),n=this._audioContext.createAnalyser();if(this.useBandPass){const e=this._audioContext.createBiquadFilter();e.type="bandpass",e.frequency.value=this.bandPassFrequency,e.gain.Q=this.bandPassQ,t.connect(e),e.connect(s),n.smoothingTimeConstant=.5}else t.connect(s),n.smoothingTimeConstant=.9;n.fftSize=this.bufferLength,n.minDecibels=-90,n.maxDecibels=-30,s.connect(n),n.connect(this._micVolumeProcessor),this._analyserData=new Float32Array(n.frequencyBinCount),this._analyser=n,this._micVolumeProcessor.connect(this._audioContext.destination),this._eventTarget.dispatchEvent(new Event("streamReady"))}))}get state(){return this._state}get stream(){return this._stream}get isMicQuiet(){return this._isMicQuiet}get isMicMuted(){return this._isMicMuted}get isSilentRecording(){return this._isSilentRecording}get isRecording(){return"recording"===this._state}get volume(){return{instant:this._instant,slow:this._slow,clip:this._clip,max:this._maxVolume}}set onstart(e){this._eventTarget.addEventListener("start",e)}set onstop(e){this._eventTarget.addEventListener("stop",e)}set ondataavailable(e){this._eventTarget.addEventListener("dataavailable",e)}set onerror(e){this._eventTarget.addEventListener("error",e)}set onstreamready(e){this._eventTarget.addEventListener("streamready",e)}set onmute(e){this._eventTarget.addEventListener("mute",e)}set onunmute(e){this._eventTarget.addEventListener("unmute",e)}set onsilentrecording(e){this._eventTarget.addEventListener("silentrecording",e)}set onunsilentrecording(e){this._eventTarget.addEventListener("unsilentrecording",e)}set onquiet(e){this._eventTarget.addEventListener("quiet",e)}set onunquiet(e){this._eventTarget.addEventListener("unquiet",e)}}},22202:(e,t,s)=>{"use strict";s.a(e,(async(e,n)=>{try{s.d(t,{A:()=>M});s(44114),s(98992),s(54520),s(72577),s(3949),s(81454),s(8872),s(14603),s(47566),s(98721);var i=s(11998),o=s(64413),r=s(51740),a=s(18578),c=s(9032),l=s(91715),u=s(57064),d=s(55831),h=s(71642),p=s(85537),g=s(96763),m=s(48287)["Buffer"],v=e([r,a,c]);[r,a,c]=v.then?(await v)():v;const f=s(18423);let b,y,C,A,w,x,k,S={},I={},T={};const M={initCredentials(e,t){switch(e.state.awsCreds.provider){case"cognito":return b=t,C&&C.initCredentials(b),e.dispatch("getCredentials");case"parentWindow":return e.dispatch("getCredentials");default:return Promise.reject(new Error("unknown credential provider"))}},getConfigFromParent(e){return e.state.isRunningEmbedded?e.dispatch("sendMessageToParentWindow",{event:"initIframeConfig"}).then((e=>"resolve"===e.event&&"initIframeConfig"===e.type?Promise.resolve(e.data):Promise.reject(new Error("invalid config event from parent")))):Promise.resolve({})},initConfig(e,t){e.commit("mergeConfig",t)},sendInitialUtterance(e){if(e.state.config.lex.initialUtterance){const t={type:e.state.config.ui.hideButtonMessageBubble?"button":"human",text:e.state.config.lex.initialUtterance};e.dispatch("postTextMessage",t)}},initMessageList(e){e.commit("reloadMessages"),e.state.messages&&0===e.state.messages.length&&e.state.config.lex.initialText.length>0&&e.commit("pushMessage",{type:"bot",text:e.state.config.lex.initialText})},initLexClient(e,t){return C=new h.A({botName:e.state.config.lex.botName,botAlias:e.state.config.lex.botAlias,lexRuntimeClient:t.v1client,botV2Id:e.state.config.lex.v2BotId,botV2AliasId:e.state.config.lex.v2BotAliasId,botV2LocaleId:e.state.config.lex.v2BotLocaleId,lexRuntimeV2Client:t.v2client}),e.commit("setLexSessionAttributes",e.state.config.lex.sessionAttributes),e.dispatch("getCredentials").then((()=>{C.initCredentials(b),"true"===String(e.state.config.lex.allowStreamingResponses)&&e.dispatch("InitWebSocketConnect")}))},initPollyClient(e,t){return e.state.recState.isRecorderEnabled?(y=t,e.commit("setPollyVoiceId",e.state.config.polly.voiceId),e.dispatch("getCredentials").then((e=>{y.config.credentials=e}))):Promise.resolve()},initRecorder(e){return e.state.config.recorder.enable?(w=new i.A(e.state.config.recorder),w.init().then((()=>w.initOptions(e.state.config.recorder))).then((()=>(0,o.A)(e,w))).then((()=>e.commit("setIsRecorderSupported",!0))).then((()=>e.commit("setIsMicMuted",w.isMicMuted))).catch((t=>{["PermissionDeniedError","NotAllowedError"].indexOf(t.name)>=0?(g.warn("get user media permission denied"),e.dispatch("pushErrorMessage","It seems like the microphone access has been denied. If you want to use voice, please allow mic usage in your browser.")):g.error("error while initRecorder",t)}))):(e.commit("setIsRecorderEnabled",!1),Promise.resolve())},initBotAudio(e,t){if(!e.state.recState.isRecorderEnabled||!e.state.config.recorder.enable)return Promise.resolve();if(!t)return Promise.reject(new Error("invalid audio element"));let s;return A=t,""!==A.canPlayType("audio/ogg")?(e.commit("setAudioContentType","ogg"),s=l):""!==A.canPlayType("audio/mp3")?(e.commit("setAudioContentType","mp3"),s=u):(g.error("init audio could not find supportted audio type"),g.warn("init audio can play mp3 [%s]",A.canPlayType("audio/mp3")),g.warn("init audio can play ogg [%s]",A.canPlayType("audio/ogg"))),g.info("recorder content types: %s",w.mimeType),A.preload="auto",A.src=s,A.autoplay=!1,Promise.resolve()},reInitBot(e){return e.state.config.lex.reInitSessionAttributesOnRestart&&e.commit("setLexSessionAttributes",e.state.config.lex.sessionAttributes),e.state.config.ui.pushInitialTextOnRestart&&e.commit("pushMessage",{type:"bot",text:e.state.config.lex.initialText,alts:{markdown:e.state.config.lex.initialText}}),Promise.resolve()},getAudioUrl(e,t){let s;try{s=URL.createObjectURL(t)}catch(n){g.error("getAudioUrl createObjectURL error",n);const e=`There was an error processing the audio response: (${n})`,t=new Error(e);return Promise.reject(t)}return Promise.resolve(s)},setAudioAutoPlay(e){return A.autoplay?Promise.resolve():new Promise(((t,s)=>{A.play(),A.onended=()=>{e.commit("setAudioAutoPlay",{audio:A,status:!0}),t()},A.onerror=t=>{e.commit("setAudioAutoPlay",{audio:A,status:!1}),s(new Error(`setting audio autoplay failed: ${t}`))}}))},playAudio(e,t){return new Promise((s=>{A.onloadedmetadata=()=>{e.commit("setIsBotSpeaking",!0),e.dispatch("playAudioHandler").then((()=>s()))},A.src=t}))},playAudioHandler(e){return new Promise(((t,s)=>{const{enablePlaybackInterrupt:n}=e.state.config.lex,i=()=>{e.commit("setIsBotSpeaking",!1);const t=e.state.botAudio.interruptIntervalId;t&&n&&(clearInterval(t),e.commit("setBotPlaybackInterruptIntervalId",0),e.commit("setIsLexInterrupting",!1),e.commit("setCanInterruptBotPlayback",!1),e.commit("setIsBotPlaybackInterrupting",!1))};A.onerror=e=>{i(),s(new Error(`There was an error playing the response (${e})`))},A.onended=()=>{i(),t()},A.onpause=A.onended,n&&e.dispatch("playAudioInterruptHandler")}))},playAudioInterruptHandler(e){const{isSpeaking:t}=e.state.botAudio,{enablePlaybackInterrupt:s,playbackInterruptMinDuration:n,playbackInterruptVolumeThreshold:i,playbackInterruptLevelThreshold:o,playbackInterruptNoiseThreshold:r}=e.state.config.lex,a=200;if(!s&&!t&&e.state.lex.isInterrupting&&A.duration<n)return;const c=setInterval((()=>{const{duration:t}=A,s=A.played.end(0),{canInterrupt:a}=e.state.botAudio;!a&&s>n&&t-s>.5&&w.volume.max<r?e.commit("setCanInterruptBotPlayback",!0):a&&t-s<.5&&e.commit("setCanInterruptBotPlayback",!1),a&&w.volume.max>i&&w.volume.slow>o&&(clearInterval(c),e.commit("setIsBotPlaybackInterrupting",!0),setTimeout((()=>{A.pause()}),500))}),a);e.commit("setBotPlaybackInterruptIntervalId",c)},getAudioProperties(){return A?{currentTime:A.currentTime,duration:A.duration,end:A.played.length>=1?A.played.end(0):A.duration,ended:A.ended,paused:A.paused}:{}},startConversation(e){return A.pause(),e.commit("setIsConversationGoing",!0),e.dispatch("startRecording")},stopConversation(e){e.commit("setIsConversationGoing",!1)},startRecording(e){return!0===e.state.recState.isMicMuted?(g.warn("recording while muted"),e.dispatch("stopConversation"),Promise.reject(new Error("The microphone seems to be muted."))):(e.commit("startRecording",w),Promise.resolve())},stopRecording(e){e.commit("stopRecording",w)},getRecorderVolume(e){return e.state.recState.isRecorderEnabled?w.volume:Promise.resolve()},pollyGetBlob(e,t,s="text"){return e.dispatch("refreshAuthTokens").then((()=>e.dispatch("getCredentials"))).then((n=>{y.config.credentials=n;const i=y.synthesizeSpeech({Text:t,VoiceId:e.state.polly.voiceId,OutputFormat:e.state.polly.outputFormat,TextType:s});return i.promise()})).then((e=>{const t=new Blob([e.AudioStream],{type:e.ContentType});return Promise.resolve(t)}))},pollySynthesizeSpeech(e,t,s="text"){return e.dispatch("pollyGetBlob",t,s).then((t=>e.dispatch("getAudioUrl",t))).then((t=>e.dispatch("playAudio",t)))},pollySynthesizeInitialSpeech(e){const t=localStorage.getItem("selectedLocale")?localStorage.getItem("selectedLocale"):e.state.config.lex.v2BotLocaleId.split(",")[0].trim();return t in S?Promise.resolve(S[t]):fetch(`./initial_speech_${t}.mp3`).then((e=>e.blob())).then((s=>(S[t]=s,e.dispatch("getAudioUrl",s)))).then((t=>e.dispatch("playAudio",t)))},pollySynthesizeAllDone:function(e){const t=localStorage.getItem("selectedLocale")?localStorage.getItem("selectedLocale"):e.state.config.lex.v2BotLocaleId.split(",")[0].trim();return t in I?Promise.resolve(I[t]):fetch(`./all_done_${t}.mp3`).then((e=>e.blob())).then((e=>(I[t]=e,Promise.resolve(e))))},pollySynthesizeThereWasAnError(e){const t=localStorage.getItem("selectedLocale")?localStorage.getItem("selectedLocale"):e.state.config.lex.v2BotLocaleId.split(",")[0].trim();return t in T?Promise.resolve(T[t]):fetch(`./there_was_an_error_${t}.mp3`).then((e=>e.blob())).then((e=>(T[t]=e,Promise.resolve(e))))},interruptSpeechConversation(e){return e.state.recState.isConversationGoing||e.state.botAudio.isSpeaking?new Promise(((t,s)=>{e.dispatch("stopConversation").then((()=>e.dispatch("stopRecording"))).then((()=>{e.state.botAudio.isSpeaking&&A.pause()})).then((()=>{let n=0;const i=20,o=250;e.commit("setIsLexInterrupting",!0);const r=setInterval((()=>{e.state.lex.isProcessing||(clearInterval(r),e.commit("setIsLexInterrupting",!1),t()),n>i&&(clearInterval(r),e.commit("setIsLexInterrupting",!1),s(new Error("interrupt interval exceeded"))),n+=1}),o)}))})):Promise.resolve()},playSound(e,t){document.getElementById("sound").innerHTML=`<audio autoplay="autoplay"><source src="${t}" type="audio/mpeg" /><embed hidden="true" autostart="true" loop="false" src="${t}" /></audio>`},setSessionAttribute(e,t){return Promise.resolve(e.commit("setLexSessionAttributeValue",t))},postTextMessage(e,t){return e.state.isSFXOn&&!e.state.lex.isPostTextRetry&&e.dispatch("playSound",e.state.config.ui.messageSentSFX),e.dispatch("interruptSpeechConversation").then((()=>e.state.chatMode===r.UD.BOT?e.dispatch("pushMessage",t):Promise.resolve())).then((()=>{const s=e.state.config.connect.liveChatTerms?e.state.config.connect.liveChatTerms.toLowerCase().split(",").map((e=>e.trim())):[];return e.state.config.ui.enableLiveChat&&s.find((e=>e===t.text.toLowerCase()))&&e.state.chatMode===r.UD.BOT?e.dispatch("requestLiveChat"):e.state.liveChat.status===r.nY.REQUEST_USERNAME?(e.commit("setLiveChatUserName",t.text),e.dispatch("requestLiveChat")):e.state.chatMode===r.UD.LIVECHAT&&e.state.liveChat.status===r.nY.ESTABLISHED?e.dispatch("sendChatMessage",t.text):Promise.resolve(e.commit("pushUtterance",t.text))})).then((()=>e.state.chatMode===r.UD.BOT&&e.state.liveChat.status!=r.nY.REQUEST_USERNAME?e.dispatch("lexPostText",t.text):Promise.resolve())).then((t=>{if(e.state.chatMode===r.UD.BOT&&e.state.liveChat.status!=r.nY.REQUEST_USERNAME)if(t.sessionState||t.message&&t.message.includes('{"messages":')){if(t.message&&t.message.includes('{"messages":')){const s=JSON.parse(t.message);s&&Array.isArray(s.messages)&&s.messages.forEach(((n,i)=>{let o=JSON.parse(t.sessionAttributes.appContext||"{}").altMessages;"CustomPayload"!==n.type&&"CustomPayload"!==n.contentType||(void 0===o&&(o={}),o.markdown=n.value?n.value:n.content);let r=JSON.parse(t.sessionAttributes.appContext||"{}").responseCard;void 0===r&&(r=e.state.lex.responseCard),e.dispatch("pushMessage",{text:n.value?n.value:n.content?n.content:"",isLastMessageInGroup:n.isLastMessageInGroup?n.isLastMessageInGroup:"true",type:"bot",dialogState:e.state.lex.dialogState,responseCard:s.messages.length-1===i?r:void 0,alts:o,responseCardsLexV2:t.responseCardLexV2})}))}}else{let s=JSON.parse(t.sessionAttributes.appContext||"{}").altMessages,n=JSON.parse(t.sessionAttributes.appContext||"{}").responseCard;"CustomPayload"===t.messageFormat&&(void 0===s&&(s={}),s.markdown=t.message),void 0===n&&(n=e.state.lex.responseCard),e.dispatch("pushMessage",{text:t.message,type:"bot",dialogState:e.state.lex.dialogState,responseCard:n,alts:s})}return Promise.resolve()})).then((()=>{e.state.isSFXOn&&(e.dispatch("playSound",e.state.config.ui.messageReceivedSFX),e.dispatch("sendMessageToParentWindow",{event:"messageReceived"})),"Fulfilled"===e.state.lex.dialogState&&e.dispatch("reInitBot"),e.state.lex.isPostTextRetry&&e.commit("setPostTextRetry",!1)})).catch((s=>{if(-1===s.message.indexOf("permissible time")||!1===e.state.config.lex.retryOnLexPostTextTimeout||e.state.lex.isPostTextRetry&&e.state.lex.retryCountPostTextTimeout>=e.state.config.lex.retryCountPostTextTimeout){e.commit("setPostTextRetry",!1);const t=e.state.config.ui.showErrorDetails?` ${s}`:"";g.error("error in postTextMessage",s),e.dispatch("pushErrorMessage",`Sorry, I was unable to process your message. Try again later.${t}`)}else e.commit("setPostTextRetry",!0),e.dispatch("postTextMessage",t)}))},deleteSession(e){return e.commit("setIsLexProcessing",!0),e.dispatch("refreshAuthTokens").then((()=>e.dispatch("getCredentials"))).then((()=>C.deleteSession())).then((t=>(e.commit("setIsLexProcessing",!1),e.dispatch("updateLexState",t).then((()=>Promise.resolve(t)))))).catch((t=>{g.error(t),e.commit("setIsLexProcessing",!1)}))},startNewSession(e){return e.commit("setIsLexProcessing",!0),e.dispatch("refreshAuthTokens").then((()=>e.dispatch("getCredentials"))).then((()=>C.startNewSession())).then((t=>(e.commit("setIsLexProcessing",!1),e.dispatch("updateLexState",t).then((()=>Promise.resolve(t)))))).catch((t=>{g.error(t),e.commit("setIsLexProcessing",!1)}))},lexPostText(e,t){e.commit("setIsLexProcessing",!0),e.commit("reapplyTokensToSessionAttributes");const s=e.state.lex.sessionAttributes;e.commit("removeAppContext");const n=e.state.config.lex.v2BotLocaleId?e.state.config.lex.v2BotLocaleId.split(",")[0]:void 0;C.userId;return e.dispatch("refreshAuthTokens").then((()=>e.dispatch("getCredentials"))).then((()=>("true"===String(e.state.config.lex.allowStreamingResponses)&&(e.commit("setIsStartingTypingWsMessages",!0),k.onmessage=t=>{"/stop/"!==t.data&&e.getters.isStartingTypingWsMessages()?(g.info("Streaming: ",e.getters.isStartingTypingWsMessages()),e.commit("pushWebSocketMessage",t.data),e.dispatch("typingWsMessages")):g.info("Currently not streaming")}),C.postText(t,n,s)))).then((t=>(e.commit("setIsStartingTypingWsMessages",!1),e.commit("setIsLexProcessing",!1),e.dispatch("updateLexState",t).then((()=>{e.state.lex.sessionAttributes.talkdesk_conversation_id&&e.state.lex.sessionAttributes.talkdesk_conversation_id!=e.state.liveChat.talkDeskConversationId&&(e.commit("setTalkDeskConversationId",e.state.lex.sessionAttributes.talkdesk_conversation_id),e.dispatch("requestLiveChat"))})).then((()=>Promise.resolve(t)))))).catch((t=>{throw e.commit("setIsStartingTypingWsMessages",!1),e.commit("setIsLexProcessing",!1),t}))},lexPostContent(e,t,s=0){e.commit("setIsLexProcessing",!0),e.commit("reapplyTokensToSessionAttributes");const n=e.state.lex.sessionAttributes;let i;return delete n.appContext,g.info("audio blob size:",t.size),e.dispatch("refreshAuthTokens").then((()=>e.dispatch("getCredentials"))).then((()=>{const o=e.state.config.lex.v2BotLocaleId?e.state.config.lex.v2BotLocaleId.split(",")[0]:void 0;return i=performance.now(),C.postContent(t,o,n,e.state.lex.acceptFormat,s)})).then((t=>{const s=performance.now();return g.info("lex postContent processing time:",((s-i)/1e3).toFixed(2)),e.commit("setIsLexProcessing",!1),e.dispatch("updateLexState",t).then((()=>e.dispatch("processLexContentResponse",t))).then((e=>Promise.resolve(e)))})).catch((t=>{throw e.commit("setIsLexProcessing",!1),t}))},processLexContentResponse(e,t){const{audioStream:s,contentType:n,dialogState:i}=t;return Promise.resolve().then((()=>s&&s.length?Promise.resolve(new Blob([s],{type:n})):"ReadyForFulfillment"===i?e.dispatch("pollySynthesizeAllDone"):e.dispatch("pollySynthesizeThereWasAnError")))},updateLexState(e,t){const s={dialogState:"",inputTranscript:"",intentName:"",message:"",responseCard:null,sessionAttributes:{},slotToElicit:"",slots:{}};if("sessionAttributes"in t&&"appContext"in t.sessionAttributes)try{const e=JSON.parse(t.sessionAttributes.appContext);"responseCard"in e&&(s.responseCard=e.responseCard)}catch(n){const e=new Error(`error parsing appContext in sessionAttributes: ${n}`);return Promise.reject(e)}if(e.commit("updateLexState",{...s,...t}),e.state.isRunningEmbedded){let t=JSON.parse(JSON.stringify(e.state.lex));e.dispatch("sendMessageToParentWindow",{event:"updateLexState",state:t})}return Promise.resolve()},pushMessage(e,t){!1===e.state.lex.isPostTextRetry&&e.commit("pushMessage",t)},pushLiveChatMessage(e,t){e.commit("pushLiveChatMessage",t)},pushErrorMessage(e,t,s="Failed"){e.commit("pushMessage",{type:"bot",text:t,dialogState:s})},initLiveChat(e){return s(31153),window.connect?(window.connect.ChatSession.setGlobalConfig({region:e.state.config.region}),Promise.resolve()):Promise.reject(new Error("failed to find Connect Chat JS global variable"))},initLiveChatSession(e){if(g.info("initLiveChat"),g.info("config connect",e.state.config.connect),!e.state.config.ui.enableLiveChat)return g.error("error in initLiveChatSession() enableLiveChat is not true in config"),Promise.reject(new Error("error in initLiveChatSession() enableLiveChat is not true in config"));if(!e.state.config.connect.apiGatewayEndpoint&&!e.state.config.connect.talkDeskWebsocketEndpoint)return g.error("error in initLiveChatSession() apiGatewayEndpoint or talkDeskWebsocketEndpoint is not set in config"),Promise.reject(new Error("error in initLiveChatSession() apiGatewayEndpoint or talkDeskWebsocketEndpoint is not set in config"));if(e.state.config.connect.apiGatewayEndpoint){if(!e.state.config.connect.contactFlowId)return g.error("error in initLiveChatSession() contactFlowId is not set in config"),Promise.reject(new Error("error in initLiveChatSession() contactFlowId is not set in config"));if(!e.state.config.connect.instanceId)return g.error("error in initLiveChatSession() instanceId is not set in config"),Promise.reject(new Error("error in initLiveChatSession() instanceId is not set in config"));e.commit("setLiveChatStatus",r.nY.INITIALIZING),g.log(e.state.lex);const t=Object.keys(e.state.lex.sessionAttributes).filter((function(e){return e.startsWith("connect_")||"topic"===e})).reduce((function(t,s){return t[s]=e.state.lex.sessionAttributes[s],t}),{}),s={Attributes:t,ParticipantDetails:{DisplayName:e.getters.liveChatUserName()},ContactFlowId:e.state.config.connect.contactFlowId,InstanceId:e.state.config.connect.instanceId},n=new URL(e.state.config.connect.apiGatewayEndpoint),i=new f.Endpoint(n.hostname),o=new f.HttpRequest(i,e.state.config.region);o.method="POST",o.path=n.pathname,o.headers["Content-Type"]="application/json",o.body=JSON.stringify(s),o.headers.Host=i.host,o.headers["Content-Length"]=m.byteLength(o.body);const c=new f.Signers.V4(o,"execute-api");c.addAuthorization(b,new Date);const l={method:"POST",mode:"cors",headers:o.headers,body:o.body};return fetch(e.state.config.connect.apiGatewayEndpoint,l).then((e=>e.json())).then((e=>e.data)).then((t=>{function s(e,t,s){e.commit("pushLiveChatMessage",{type:t,text:s})}if(g.info("Live Chat Config Success:",t),e.commit("setLiveChatStatus",r.nY.CONNECTING),e.state.config.connect.waitingForAgentMessageIntervalSeconds>0){const t=setInterval(s,1e3*e.state.config.connect.waitingForAgentMessageIntervalSeconds,e,"bot",e.state.config.connect.waitingForAgentMessage);g.info(`interval now set: ${t}`),e.commit("setLiveChatIntervalId",t)}return x=(0,a.Np)(t),g.info("Live Chat Session Created:",x),(0,a.C9)(e,x),g.info("Live Chat Handlers initialised:"),(0,a.VP)(x)})).then((t=>(g.info("live Chat session connection response",t),g.info("Live Chat Session CONNECTED:",x),e.commit("setLiveChatStatus",r.nY.ESTABLISHED),Promise.resolve()))).catch((t=>(g.error("Error esablishing live chat"),e.commit("setLiveChatStatus",r.nY.ENDED),Promise.resolve())))}return e.state.config.connect.talkDeskWebsocketEndpoint?(x=(0,c.wV)(e),Promise.resolve()):void 0},requestLiveChat(e){g.info("requestLiveChat"),e.getters.liveChatUserName()?(e.commit("setLiveChatStatus",r.nY.REQUESTED),e.commit("setChatMode",r.UD.LIVECHAT),e.commit("setIsLiveChatProcessing",!0),e.dispatch("initLiveChatSession")):(e.commit("setLiveChatStatus",r.nY.REQUEST_USERNAME),e.commit("pushMessage",{text:e.state.config.connect.promptForNameMessage,type:"bot"}))},sendTypingEvent(e){g.info("actions: sendTypingEvent"),e.state.chatMode===r.UD.LIVECHAT&&x&&e.state.config.connect.apiGatewayEndpoint&&(0,a.Yb)(x)},sendChatMessage(e,t){g.info("actions: sendChatMessage"),e.state.chatMode===r.UD.LIVECHAT&&x&&(e.state.config.connect.apiGatewayEndpoint?(0,a.gJ)(x,t):e.state.config.connect.talkDeskWebsocketEndpoint&&((0,c.vp)(e,x,t),e.dispatch("pushMessage",{text:t,type:"human",dialogState:e.state.lex.dialogState})))},requestLiveChatEnd(e){g.info("actions: endLiveChat"),e.commit("clearLiveChatIntervalId"),e.state.chatMode===r.UD.LIVECHAT&&x&&(e.state.config.connect.apiGatewayEndpoint?(0,a.Br)(x):e.state.config.connect.talkDeskWebsocketEndpoint&&(0,c.MY)(e,x,"agent"),e.dispatch("pushLiveChatMessage",{type:"agent",text:e.state.config.connect.chatEndedMessage}),e.dispatch("liveChatSessionEnded"),e.commit("setLiveChatStatus",r.nY.ENDED))},agentIsTyping(e){g.info("actions: agentIsTyping"),e.commit("setIsLiveChatProcessing",!0)},liveChatSessionReconnectRequest(e){g.info("actions: liveChatSessionReconnectRequest"),e.commit("setLiveChatStatus",r.nY.DISCONNECTED)},liveChatSessionEnded(e){if(g.info("actions: liveChatSessionEnded"),g.info(`connect config is : ${e.state.config.connect}`),e.state.config.connect.endLiveChatUtterance&&e.state.config.connect.endLiveChatUtterance.length>0){const t={type:e.state.config.ui.hideButtonMessageBubble?"button":"human",text:e.state.config.connect.endLiveChatUtterance};e.dispatch("postTextMessage",t),g.info("dispatching request to send message")}x=null,e.commit("setLiveChatStatus",r.nY.ENDED),e.commit("setChatMode",r.UD.BOT),e.commit("clearLiveChatIntervalId")},liveChatAgentJoined(e){e.commit("clearLiveChatIntervalId")},getCredentialsFromParent(e){const t=b&&b.expireTime?b.expireTime:0,s=new Date(t).getTime(),n=Date.now();return s>n?Promise.resolve(b):e.dispatch("sendMessageToParentWindow",{event:"getCredentials"}).then((e=>{if("resolve"===e.event&&"getCredentials"===e.type)return Promise.resolve(e.data);const t=new Error("invalid credential event from parent");return Promise.reject(t)})).then((e=>{const{AccessKeyId:t,SecretKey:s,SessionToken:n}=e.data.Credentials,{IdentityId:i}=e.data;return b={accessKeyId:t,secretAccessKey:s,sessionToken:n,identityId:i,expired:!1,getPromise(){return Promise.resolve(b)}},b}))},getCredentials(e){return"parentWindow"===e.state.awsCreds.provider?e.dispatch("getCredentialsFromParent"):b.getPromise().then((()=>b))},refreshAuthTokensFromParent(e){return e.dispatch("sendMessageToParentWindow",{event:"refreshAuthTokens"}).then((t=>{if("resolve"===t.event&&"refreshAuthTokens"===t.type)return Promise.resolve(t.data);if(e.state.isRunningEmbedded){const e=new Error("invalid refresh token event from parent");return Promise.reject(e)}return Promise.resolve("outofbandrefresh")})).then((t=>(e.state.isRunningEmbedded&&e.commit("setTokens",t),Promise.resolve())))},refreshAuthTokens(e){function t(e){if(e){const t=(0,p.s)(e);if(t){const e=Date.now(),s=1e3*(t.exp-300);return e>s}return!1}return!1}return e.state.tokens.idtokenjwt&&t(e.state.tokens.idtokenjwt)?(g.info("starting auth token refresh"),e.dispatch("refreshAuthTokensFromParent")):Promise.resolve()},toggleIsUiMinimized(e){return!e.state.initialUtteranceSent&&e.state.isUiMinimized&&(setTimeout((()=>e.dispatch("sendInitialUtterance")),500),e.commit("setInitialUtteranceSent",!0)),e.commit("toggleIsUiMinimized"),e.dispatch("sendMessageToParentWindow",{event:"toggleMinimizeUi"})},toggleIsLoggedIn(e){return e.commit("toggleIsLoggedIn"),e.dispatch("sendMessageToParentWindow",{event:"toggleIsLoggedIn"})},toggleHasButtons(e){return e.commit("toggleHasButtons"),e.dispatch("sendMessageToParentWindow",{event:"toggleHasButtons"})},toggleIsSFXOn(e){e.commit("toggleIsSFXOn")},sendMessageToParentWindow(e,t){return e.state.isRunningEmbedded?new Promise(((s,n)=>{const i=new MessageChannel;i.port1.onmessage=e=>{if(i.port1.close(),i.port2.close(),"resolve"===e.data.event)s(e.data);else{const t=`error in sendMessageToParentWindow: ${e.data.error}`;n(new Error(t))}};let o=e.state.config.ui.parentOrigin;if(o!==window.location.origin){const t=e.state.config.ui.parentOrigin.split("."),s=window.location.origin.split(".");t[0]===s[0]&&(o=window.location.origin)}window.parent.postMessage({source:"lex-web-ui",...t},o,[i.port2])})):new Promise(((e,s)=>{try{const s=new CustomEvent("fullpagecomponent",{detail:t});document.dispatchEvent(s),e(s)}catch(n){s(n)}}))},resetHistory(e){e.commit("clearMessages"),e.commit("pushMessage",{type:"bot",text:e.state.config.lex.initialText,alts:{markdown:e.state.config.lex.initialText}})},changeLocaleIds(e,t){e.commit("updateLocaleIds",t)},InitWebSocketConnect(e){const t=C.userId,s={region:e.state.config.region,service:"execute-api"},n={access_key:b.accessKeyId,secret_key:b.secretAccessKey,session_token:b.sessionToken},i=d.l.signUrl(e.state.config.lex.streamingWebSocketEndpoint+"?sessionId="+t,n,s);k=new WebSocket(i);const o=54e4,r=72e5,a=Date.now();let c=null;function l(){if(k.readyState===WebSocket.OPEN){const e=Date.now()-a;if(e<r){const e=JSON.stringify({action:"ping"});k.send(e),g.log("Sending Ping:",(new Date).toISOString()),c=setTimeout(l,o)}else g.log("Stopped sending pings after reaching 2-hour limit."),clearTimeout(c)}}k.onopen=()=>{g.log("WebSocket Connected"),l()},k.onclose=()=>{g.log("WebSocket Closed"),clearTimeout(c)},k.onerror=e=>{g.log("WebSocket Error",e.message),clearTimeout(c)}},typingWsMessages(e){e.getters.wsMessagesCurrentIndex()<e.getters.wsMessagesLength()-1&&setTimeout((()=>{e.commit("typingWsMessages")}),500)},uploadFile(e,t){const s=new f.S3({credentials:b}),n=C.userId+"/"+t.name.split(".").join("-"+Date.now()+"."),i={Body:t,Bucket:e.state.config.ui.uploadS3BucketName,Key:n};s.putObject(i,(function(s,i){if(!s){g.log(i);const s={s3Path:"s3://"+e.state.config.ui.uploadS3BucketName+"/"+n,fileName:t.name};var o=[s];return e.state.lex.sessionAttributes.userFilesUploaded&&(o=JSON.parse(e.state.lex.sessionAttributes.userFilesUploaded),o.push(s)),e.commit("setLexSessionAttributeValue",{key:"userFilesUploaded",value:JSON.stringify(o)}),e.state.config.ui.uploadSuccessMessage.length>0&&e.commit("pushMessage",{type:"bot",text:e.state.config.ui.uploadSuccessMessage}),Promise.resolve()}g.log(s,s.stack),e.commit("pushMessage",{type:"bot",text:e.state.config.ui.uploadFailureMessage})}))}};n()}catch(f){n(f)}}))},21089:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});s(44114),s(98992),s(3949);var n=s(85537);const i={canInterruptBotPlayback:e=>e.botAudio.canInterrupt,isBotSpeaking:e=>e.botAudio.isSpeaking,isConversationGoing:e=>e.recState.isConversationGoing,isLexInterrupting:e=>e.lex.isInterrupting,isLexProcessing:e=>e.lex.isProcessing,isMicMuted:e=>e.recState.isMicMuted,isMicQuiet:e=>e.recState.isMicQuiet,isRecorderSupported:e=>e.recState.isRecorderSupported,isRecording:e=>e.recState.isRecording,isBackProcessing:e=>e.isBackProcessing,lastUtterance:e=>()=>0===e.utteranceStack.length?"":e.utteranceStack[e.utteranceStack.length-1].t,userName:e=>()=>{let t="";if(e.tokens&&e.tokens.idtokenjwt){const s=(0,n.s)(e.tokens.idtokenjwt);return s&&(s.email&&(t=s.email),s.preferred_username&&(t=s.preferred_username)),`[${t}]`}return t},liveChatUserName:e=>()=>{let t="";if(e.tokens&&e.tokens.idtokenjwt){const s=(0,n.s)(e.tokens.idtokenjwt);return s&&s.preferred_username&&(t=s.preferred_username),`[${t}]`}return e.liveChat.username?e.liveChat.username:t},liveChatTextTranscriptArray:e=>()=>{const t=[];var s="";let n=!1;const i=new RegExp(`${e.config.connect.transcriptRedactRegex}`,"g");return e.messages.forEach((e=>{var o=e.date.toLocaleTimeString()+" "+("bot"===e.type?"Bot":"Human")+": "+e.text+"\n";if(n&&(o=e.date.toLocaleTimeString()+" "+("bot"===e.type?"Bot":"Human")+": ###\n"),(s+o).length>400){t.push(s);var r=o.match(/(.|[\r\n]){1,400}/g);r.forEach((e=>{t.push(e)})),s="",n=i.test(o),o=""}else n=i.test(o);s+=o})),t.push(s),t},liveChatTranscriptFile:e=>()=>{var t="Bot Transcript: \n";e.messages.forEach((e=>t=t+e.date.toLocaleTimeString()+" "+("bot"===e.type?"Bot":"Human")+": "+e.text+"\n"));var s=new Blob([t],{type:"text/plain"}),n=new File([s],"chatTranscript.txt",{lastModified:(new Date).getTime(),type:s.type});return n},wsMessages:e=>()=>e.streaming.wsMessages,wsMessagesCurrentIndex:e=>()=>e.streaming.wsMessagesCurrentIndex,wsMessagesLength:e=>()=>e.streaming.wsMessages.length,isStartingTypingWsMessages:e=>()=>e.streaming.isStartingTypingWsMessages}},55129:(e,t,s)=>{"use strict";s.a(e,(async(e,n)=>{try{s.d(t,{A:()=>l});var i=s(51740),o=s(21089),r=s(53313),a=s(22202),c=e([i,r,a]);[i,r,a]=c.then?(await c)():c;const l={strict:!1,state:i.Ay,getters:o.A,mutations:r.A,actions:a.A};n()}catch(l){n(l)}}))},18578:(e,t,s)=>{"use strict";s.a(e,(async(e,n)=>{try{s.d(t,{Br:()=>m,C9:()=>d,Np:()=>c,VP:()=>l,Yb:()=>g,gJ:()=>h});s(98992),s(3949);var i=s(51740),o=s(96763),r=e([i]);i=(r.then?(await r)():r)[0];const c=e=>window.connect.ChatSession.create({chatDetails:e.startChatResult,type:"CUSTOMER"}),l=e=>Promise.resolve(e.connect().then((e=>(o.info(`successful connection: ${JSON.stringify(e)}`),Promise.resolve(e))),(e=>(o.info(`unsuccessful connection ${JSON.stringify(e)}`),Promise.reject(e)))));function u(e,t){t&&t.initialContactId&&e.commit("setLexSessionAttributeValue",{key:"connect_initial_contact_id",value:t.initialContactId}),t&&t.contactId&&e.commit("setLexSessionAttributeValue",{key:"connect_contact_id",value:t.contactId}),t&&t.participantId&&e.commit("setLexSessionAttributeValue",{key:"connect_participant_id",value:t.participantId})}const d=(e,t)=>{t.onConnectionEstablished((t=>{o.info("Established!",t),t&&t.chatDetails&&u(e,t.chatDetails)})),t.onMessage((s=>{const{chatDetails:n,data:r}=s;o.info(`Received message: ${JSON.stringify(s)}`),o.info("Received message chatDetails:",n),n&&u(e,n);let a="";switch(r.ContentType){case"application/vnd.amazonaws.connect.event.participant.joined":switch(r.ParticipantRole){case"SYSTEM":e.commit("setIsLiveChatProcessing",!1);break;case"AGENT":e.dispatch("liveChatAgentJoined"),e.commit("setIsLiveChatProcessing",!1),e.dispatch("pushLiveChatMessage",{type:"agent",text:e.state.config.connect.agentJoinedMessage.replaceAll("{Agent}",r.DisplayName)});const s=e.getters.liveChatTextTranscriptArray();if(s.forEach(((n,i)=>{var r="Bot Transcript: ("+(i+1).toString()+"\\"+s.length+")\n"+n;p(t,r,i*e.state.config.connect.transcriptMessageDelayInMsec),o.info((i+1).toString()+"-"+r)})),e.state.config.connect.attachChatTranscript&&("true"===e.state.config.connect.attachChatTranscript||!0===e.state.config.connect.attachChatTranscript)){o.info("Sending chat transcript.");var c=e.getters.liveChatTranscriptFile();t.controller.sendAttachment({attachment:c}).then((e=>{o.info("Transcript sent.")}),(e=>{o.info("Error sending transcript.")}))}break;case"CUSTOMER":break;default:break}break;case"application/vnd.amazonaws.connect.event.participant.left":switch(r.ParticipantRole){case"SYSTEM":break;case"AGENT":e.dispatch("pushLiveChatMessage",{type:"agent",text:e.state.config.connect.agentLeftMessage.replaceAll("{Agent}",r.DisplayName)});break;case"CUSTOMER":break;default:break}break;case"application/vnd.amazonaws.connect.event.chat.ended":e.state.liveChat.status!==i.nY.ENDED&&(e.dispatch("pushLiveChatMessage",{type:"agent",text:e.state.config.connect.chatEndedMessage}),e.dispatch("liveChatSessionEnded"));break;case"text/plain":switch(r.ParticipantRole){case"SYSTEM":a="bot";break;case"AGENT":a="agent";break;case"CUSTOMER":a="human";break;default:break}e.commit("setIsLiveChatProcessing",!1),r.Content.startsWith("Bot Transcript")||e.dispatch("pushLiveChatMessage",{type:a,text:r.Content});break;default:break}})),t.onTyping((t=>{"AGENT"===t.data.ParticipantRole&&(o.info("Agent is typing "),e.dispatch("agentIsTyping"))})),t.onConnectionBroken((t=>{o.info("Connection broken",t),e.dispatch("liveChatSessionReconnectRequest")}))},h=async(e,t)=>{await e.controller.sendMessage({message:t,contentType:"text/plain"})},p=async(e,t,s)=>{setTimeout((async()=>{await e.controller.sendMessage({message:t,contentType:"text/plain"})}),s)},g=e=>{o.info("liveChatHandler: sendTypingEvent"),e.controller.sendEvent({contentType:"application/vnd.amazonaws.connect.event.typing"})},m=e=>{o.info("liveChatHandler: endLiveChat",e),e.controller.disconnectParticipant()};n()}catch(a){n(a)}}))},53313:(e,t,s)=>{"use strict";s.a(e,(async(e,n)=>{try{s.d(t,{A:()=>c});s(44114),s(98992),s(72577),s(3949),s(81454),s(8872);var i=s(34642),o=s(51740),r=s(96763),a=e([i,o]);[i,o]=a.then?(await a)():a;const c={reloadMessages(e){const t=sessionStorage.getItem("store");if(null!==t){const s=JSON.parse(t);e.messages=s.messages.map((e=>Object.assign({},e,{date:new Date(e.date)})))}},setIsMicMuted(e,t){"boolean"===typeof t?e.config.recorder.useAutoMuteDetect&&(e.recState.isMicMuted=t):r.error("setIsMicMuted status not boolean",t)},setIsMicQuiet(e,t){"boolean"===typeof t?e.recState.isMicQuiet=t:r.error("setIsMicQuiet status not boolean",t)},setIsConversationGoing(e,t){"boolean"===typeof t?e.recState.isConversationGoing=t:r.error("setIsConversationGoing status not boolean",t)},startRecording(e,t){r.info("start recording"),!1===e.recState.isRecording&&(t.start(),e.recState.isRecording=!0)},stopRecording(e,t){!0===e.recState.isRecording&&(e.recState.isRecording=!1,t.isRecording&&t.stop())},increaseSilentRecordingCount(e){e.recState.silentRecordingCount+=1},resetSilentRecordingCount(e){e.recState.silentRecordingCount=0},setIsRecorderEnabled(e,t){"boolean"===typeof t?e.recState.isRecorderEnabled=t:r.error("setIsRecorderEnabled status not boolean",t)},setIsRecorderSupported(e,t){"boolean"===typeof t?e.recState.isRecorderSupported=t:r.error("setIsRecorderSupported status not boolean",t)},setIsBotSpeaking(e,t){"boolean"===typeof t?e.botAudio.isSpeaking=t:r.error("setIsBotSpeaking status not boolean",t)},setAudioAutoPlay(e,{audio:t,status:s}){"boolean"===typeof s?(e.botAudio.autoPlay=s,t.autoplay=s):r.error("setAudioAutoPlay status not boolean",s)},setCanInterruptBotPlayback(e,t){"boolean"===typeof t?e.botAudio.canInterrupt=t:r.error("setCanInterruptBotPlayback status not boolean",t)},setIsBotPlaybackInterrupting(e,t){"boolean"===typeof t?e.botAudio.isInterrupting=t:r.error("setIsBotPlaybackInterrupting status not boolean",t)},setBotPlaybackInterruptIntervalId(e,t){"number"===typeof t?e.botAudio.interruptIntervalId=t:r.error("setIsBotPlaybackInterruptIntervalId id is not a number",t)},updateLexState(e,t){e.lex={...e.lex,...t}},setLexSessionAttributes(e,t){"object"===typeof t?e.lex.sessionAttributes=t:r.error("sessionAttributes is not an object",t)},setLexSessionAttributeValue(e,t){try{const s=(e,t,s)=>t.split(".").reduce(((e,n,i)=>e[n]=t.split(".").length===++i?s:e[n]||{}),e);s(e.lex.sessionAttributes,t.key,t.value)}catch(s){r.error(`could not set session attribute: ${s} for ${JSON.stringify(t)}`)}},setIsLexProcessing(e,t){"boolean"===typeof t?e.lex.isProcessing=t:r.error("setIsLexProcessing status not boolean",t)},removeAppContext(e){const t=e.lex.sessionAttributes;delete t.appContext},setIsLexInterrupting(e,t){"boolean"===typeof t?e.lex.isInterrupting=t:r.error("setIsLexInterrupting status not boolean",t)},setAudioContentType(e,t){switch(t){case"mp3":case"mpg":case"mpeg":e.polly.outputFormat="mp3",e.lex.acceptFormat="audio/mpeg";break;case"ogg":case"ogg_vorbis":case"x-cbr-opus-with-preamble":default:e.polly.outputFormat="ogg_vorbis",e.lex.acceptFormat="audio/ogg";break}},setPollyVoiceId(e,t){"string"===typeof t?e.polly.voiceId=t:r.error("polly voiceId is not a string",t)},mergeConfig(e,t){if("object"!==typeof t)return void r.error("config is not an object",t);e.config.region=t.cognito.poolId.split(":")[0]||"us-east-1";const s=e.config&&e.config.ui&&e.config.ui.parentOrigin?e.config.ui.parentOrigin:t.ui.parentOrigin||window.location.origin,n={...t,ui:{...t.ui,parentOrigin:s}};e.config&&e.config.ui&&e.config.ui.parentOrigin&&t.ui&&t.ui.parentOrigin&&t.ui.parentOrigin!==e.config.ui.parentOrigin&&r.warn("ignoring parentOrigin in config: ",t.ui.parentOrigin),e.config=(0,i.R)(e.config,n)},setIsRunningEmbedded(e,t){"boolean"===typeof t?e.isRunningEmbedded=t:r.error("setIsRunningEmbedded status not boolean",t)},toggleIsUiMinimized(e){e.isUiMinimized=!e.isUiMinimized},setInitialUtteranceSent(e){e.initialUtteranceSent=!0},toggleIsSFXOn(e){e.isSFXOn=!e.isSFXOn},toggleHasButtons(e){e.hasButtons=!e.hasButtons},setIsLoggedIn(e,t){e.isLoggedIn=t},setIsSaveHistory(e,t){e.isSaveHistory=t},setChatMode(e,t){"string"===typeof t&&Object.values(o.UD).find((e=>e===t.toLowerCase()))?e.chatMode=t.toLowerCase():r.error("chatMode is not vaild",t.toLowerCase())},setLiveChatIntervalId(e,t){e.liveChat.intervalId=t},clearLiveChatIntervalId(e){e.liveChat.intervalId&&(clearInterval(e.liveChat.intervalId),e.liveChat.intervalId=void 0)},setLiveChatStatus(e,t){"string"===typeof t&&Object.values(o.nY).find((e=>e===t.toLowerCase()))?e.liveChat.status=t.toLowerCase():r.error("liveChatStatus is not vaild",t.toLowerCase())},setTalkDeskConversationId(e,t){"string"===typeof t?e.liveChat.talkDeskConversationId=t:r.error("setTalkDeskConversationId is not vaild",t)},setIsLiveChatProcessing(e,t){"boolean"===typeof t?e.liveChat.isProcessing=t:r.error("setIsLiveChatProcessing status not boolean",t)},setLiveChatUserName(e,t){"string"===typeof t?e.liveChat.username=t:r.error("setLiveChatUserName is not vaild",t)},reset(e){const t={messages:[],utteranceStack:[]};Object.keys(t).forEach((s=>{e[s]=t[s]}))},reapplyTokensToSessionAttributes(e){e&&(e.tokens.idtokenjwt&&(r.error("found idtokenjwt"),e.lex.sessionAttributes.idtokenjwt=e.tokens.idtokenjwt),e.tokens.accesstokenjwt&&(r.error("found accesstokenjwt"),e.lex.sessionAttributes.accesstokenjwt=e.tokens.accesstokenjwt),e.tokens.refreshtoken&&(r.error("found refreshtoken"),e.lex.sessionAttributes.refreshtoken=e.tokens.refreshtoken))},setTokens(e,t){t?(e.tokens.idtokenjwt=t.idtokenjwt,e.tokens.accesstokenjwt=t.accesstokenjwt,e.tokens.refreshtoken=t.refreshtoken,e.lex.sessionAttributes.idtokenjwt=t.idtokenjwt,e.lex.sessionAttributes.accesstokenjwt=t.accesstokenjwt,e.lex.sessionAttributes.refreshtoken=t.refreshtoken):e.tokens=void 0},pushMessage(e,t){e.messages.push({id:e.messages.length,date:new Date,...t})},pushLiveChatMessage(e,t){e.messages.push({id:e.messages.length,date:new Date,...t})},setAwsCredsProvider(e,t){e.awsCreds.provider=t},pushUtterance(e,t){e.isBackProcessing?e.isBackProcessing=!e.isBackProcessing:(e.utteranceStack.push({t}),e.utteranceStack.length>1e3&&e.utteranceStack.shift())},popUtterance(e){0!==e.utteranceStack.length&&e.utteranceStack.pop()},toggleBackProcessing(e){e.isBackProcessing=!e.isBackProcessing},clearMessages(e){e.messages=[],e.lex.sessionAttributes={}},setPostTextRetry(e,t){"boolean"===typeof t?(!1===t?e.lex.retryCountPostTextTimeout=0:e.lex.retryCountPostTextTimeout+=1,e.lex.isPostTextRetry=t):r.error("setPostTextRetry status not boolean",t)},updateLocaleIds(e,t){e.config.lex.v2BotLocaleId=t.trim().replace(/ /g,"")},toggleIsVoiceOutput(e,t){e.botAudio.isVoiceOutput=t},pushWebSocketMessage(e,t){e.streaming.wsMessages.push(t)},typingWsMessages(e){e.streaming.isStartingTypingWsMessages?(e.streaming.wsMessagesString=e.streaming.wsMessagesString.concat(e.streaming.wsMessages[e.streaming.wsMessagesCurrentIndex]),e.streaming.wsMessagesCurrentIndex++):e.streaming.isStartingTypingWsMessages&&(e.streaming.isStartingTypingWsMessages=!1,e.streaming.wsMessagesString="",e.streaming.wsMessages=[],e.streaming.wsMessagesCurrentIndex=0)},setIsStartingTypingWsMessages(e,t){e.streaming.isStartingTypingWsMessages=t,t||(e.streaming.wsMessagesString="",e.streaming.wsMessages=[],e.streaming.wsMessagesCurrentIndex=0)}};n()}catch(c){n(c)}}))},64413:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});s(98992),s(3949);var n=s(96763);const i=(e,t)=>{t.onstart=()=>{n.info("recorder start event triggered"),n.time("recording time")},t.onstop=()=>{e.dispatch("stopRecording"),n.timeEnd("recording time"),n.time("recording processing time"),n.info("recorder stop event triggered")},t.onsilentrecording=()=>{n.info("recorder silent recording triggered"),e.commit("increaseSilentRecordingCount")},t.onunsilentrecording=()=>{e.state.recState.silentRecordingCount>0&&e.commit("resetSilentRecordingCount")},t.onerror=e=>{n.error("recorder onerror event triggered",e)},t.onstreamready=()=>{n.info("recorder stream ready event triggered")},t.onmute=()=>{n.info("recorder mute event triggered"),e.commit("setIsMicMuted",!0)},t.onunmute=()=>{n.info("recorder unmute event triggered"),e.commit("setIsMicMuted",!1)},t.onquiet=()=>{n.info("recorder quiet event triggered"),e.commit("setIsMicQuiet",!0)},t.onunquiet=()=>{n.info("recorder unquiet event triggered"),e.commit("setIsMicQuiet",!1)},t.ondataavailable=s=>{const{mimeType:i}=t;n.info("recorder data available event triggered");const o=new Blob([s.detail],{type:i});let r=0;i.startsWith("audio/ogg")&&(r=125+s.detail[125]+1),n.timeEnd("recording processing time"),e.dispatch("lexPostContent",o,r).then((t=>{if(e.state.recState.silentRecordingCount>=e.state.config.converser.silentConsecutiveRecordingMax){const t=`Too many consecutive silent recordings: ${e.state.recState.silentRecordingCount}.`;return Promise.reject(new Error(t))}return Promise.all([e.dispatch("getAudioUrl",o),e.dispatch("getAudioUrl",t)])})).then((t=>{if("Fulfilled"!==e.state.lex.dialogState&&!e.state.recState.isConversationGoing)return Promise.resolve();const[s,n]=t;if(e.dispatch("pushMessage",{type:"human",audio:s,text:e.state.lex.inputTranscript}),e.commit("pushUtterance",e.state.lex.inputTranscript),e.state.lex.message.includes('{"messages":')){const t=JSON.parse(e.state.lex.message);t&&Array.isArray(t.messages)&&t.messages.forEach((t=>{e.dispatch("pushMessage",{type:"bot",audio:n,text:t.value,dialogState:e.state.lex.dialogState,alts:JSON.parse(e.state.lex.sessionAttributes.appContext||"{}").altMessages,responseCard:e.state.lex.responseCard,responseCardsLexV2:e.state.lex.sessionState&&e.state.lex.sessionState.intent&&("Failed"===e.state.lex.sessionState.intent.state||"Fulfilled"===e.state.lex.sessionState.intent.state)?e.state.lex.responseCardLexV2:null})}))}else e.dispatch("pushMessage",{type:"bot",audio:n,text:e.state.lex.message,dialogState:e.state.lex.dialogState,responseCard:e.state.lex.responseCard,alts:JSON.parse(e.state.lex.sessionAttributes.appContext||"{}").altMessages});return e.dispatch("playAudio",n,{},r)})).then((()=>["Fulfilled","ReadyForFulfillment","Failed"].indexOf(e.state.lex.dialogState)>=0?e.dispatch("stopConversation").then((()=>e.dispatch("reInitBot"))):e.state.recState.isConversationGoing?e.dispatch("startRecording"):Promise.resolve())).catch((t=>{const s=e.state.config.ui.showErrorDetails?` ${t}`:"";n.error("converser error:",t),e.dispatch("stopConversation"),e.dispatch("pushErrorMessage",`Sorry, I had an error handling this conversation.${s}`),e.commit("resetSilentRecordingCount")}))}},o=i},51740:(e,t,s)=>{"use strict";s.a(e,(async(e,n)=>{try{s.d(t,{Ay:()=>c,UD:()=>r,nY:()=>a});var i=s(34642),o=e([i]);i=(o.then?(await o)():o)[0];const r={BOT:"bot",LIVECHAT:"livechat"},a={REQUESTED:"requested",REQUEST_USERNAME:"request_username",INITIALIZING:"initializing",CONNECTING:"connecting",ESTABLISHED:"established",DISCONNECTED:"disconnected",ENDED:"ended"},c={version:"0.21.7",chatMode:r.BOT,lex:{acceptFormat:"audio/ogg",dialogState:"",isInterrupting:!1,isProcessing:!1,isPostTextRetry:!1,retryCountPostTextTimeout:0,allowStreamingResponses:!1,inputTranscript:"",intentName:"",message:"",responseCard:null,sessionAttributes:i.$.lex&&i.$.lex.sessionAttributes&&"object"===typeof i.$.lex.sessionAttributes?{...i.$.lex.sessionAttributes}:{},slotToElicit:"",slots:{}},liveChat:{username:"",isProcessing:!1,status:a.DISCONNECTED,message:""},messages:[],utteranceStack:[],isBackProcessing:!1,polly:{outputFormat:"ogg_vorbis",voiceId:i.$.polly&&i.$.polly.voiceId&&"string"===typeof i.$.polly.voiceId?`${i.$.polly.voiceId}`:"Joanna"},botAudio:{canInterrupt:!1,interruptIntervalId:null,autoPlay:!1,isInterrupting:!1,isSpeaking:!1},recState:{isConversationGoing:!1,isInterrupting:!1,isMicMuted:!1,isMicQuiet:!0,isRecorderSupported:!1,isRecorderEnabled:!i.$.recorder||!!i.$.recorder.enable,isRecording:!1,silentRecordingCount:0},isRunningEmbedded:!1,isSFXOn:!!i.$.ui&&(!!i.$.ui.enableSFX&&!!i.$.ui.messageSentSFX&&!!i.$.ui.messageReceivedSFX),isUiMinimized:!1,initialUtteranceSent:!1,isEnableLogin:!1,isForceLogin:!1,isLoggedIn:!1,isSaveHistory:!1,isEnableLiveChat:!1,hasButtons:!1,tokens:{},config:i.$,awsCreds:{provider:"cognito"},streaming:{wssEndpointWithStage:"",wsMessages:[],wsMessagesCurrentIndex:0,wsMessagesString:"",isStartingTypingWsMessages:!0}};n()}catch(r){n(r)}}))},9032:(e,t,s)=>{"use strict";s.a(e,(async(e,n)=>{try{s.d(t,{MY:()=>l,vp:()=>c,wV:()=>a});var i=s(51740),o=s(96763),r=e([i]);i=(r.then?(await r)():r)[0];const a=e=>{o.log("custom initlivechat");const t=new WebSocket(`${e.state.config.connect.talkDeskWebsocketEndpoint}?conversationId=${e.state.lex.sessionAttributes.talkdesk_conversation_id}`);return t.onopen=t=>{o.info(`successful connection: ${JSON.stringify(t)}`),e.commit("setLiveChatStatus",i.nY.ESTABLISHED),e.dispatch("pushLiveChatMessage",{type:"agent",text:e.state.config.connect.agentJoinedMessage})},t.onerror=t=>{o.error(`Error occurred in live chat ${JSON.stringify(t)}`),e.commit("setLiveChatStatus",i.nY.ENDED)},t.onmessage=t=>{const{event_type:s,content:n,author_name:i}=JSON.parse(t.data);o.info("Received message data:",t.data),o.log(s,n);let r="agent";"message_created"==s&&(e.dispatch("liveChatAgentJoined"),e.commit("setIsLiveChatProcessing",!1),e.dispatch("pushLiveChatMessage",{type:r,text:n,agentName:i})),"conversation_ended"==s&&e.dispatch("agentInitiatedLiveChatEnd")},t},c=(e,t,s)=>{const n={action:"onMessage",message:s,conversationId:e.state.lex.sessionAttributes.talkdesk_conversation_id};o.log("sendChatMessage",n),t.send(JSON.stringify(n))},l=(e,t,s)=>{o.info("liveChatHandler: requestLiveChatEnd",t),t.close(4e3,`conversationId:${e.state.lex.sessionAttributes.talkdesk_conversation_id}`),e.commit("setLiveChatStatus",i.nY.ENDED)};n()}catch(a){n(a)}}))},99962:(e,t,s)=>{"use strict";s.d(t,{A:()=>A});var n=s(20641),i=s(53751),o=s(90033);const r={id:"input-button-tooltip"},a={id:"input-button-tooltip"};function c(e,t,s,c,l,u){const d=(0,n.g2)("v-text-field"),h=(0,n.g2)("recorder-status"),p=(0,n.g2)("v-tooltip"),g=(0,n.g2)("v-icon"),m=(0,n.g2)("v-btn"),v=(0,n.g2)("v-toolbar");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(v,{elevation:"3",color:"white",dense:this.$store.state.isRunningEmbedded,class:"toolbar-content"},{default:(0,n.k6)((()=>[(0,n.bo)((0,n.bF)(d,{label:s.textInputPlaceholder,disabled:u.isLexProcessing,modelValue:l.textInput,"onUpdate:modelValue":[t[0]||(t[0]=e=>l.textInput=e),u.onKeyUp],onKeyup:(0,i.withKeys)((0,i.withModifiers)(u.postTextMessage,["stop"]),["enter"]),onFocus:u.onTextFieldFocus,onBlur:u.onTextFieldBlur,ref:"textInput",id:"text-input",name:"text-input","single-line":"","hide-details":"",density:"compact",variant:"underlined",class:"toolbar-text"},null,8,["label","disabled","modelValue","onKeyup","onFocus","onBlur","onUpdate:modelValue"]),[[i.vShow,u.shouldShowTextInput]]),(0,n.bo)((0,n.bF)(h,null,null,512),[[i.vShow,!u.shouldShowTextInput]]),u.shouldShowSendButton?((0,n.uX)(),(0,n.Wv)(m,{key:0,onClick:u.postTextMessage,disabled:u.isLexProcessing||u.isSendButtonDisabled,ref:"send",class:"icon-color input-button","aria-label":"Send Message"},{default:(0,n.k6)((()=>[(0,n.bF)(p,{activator:"parent",location:"start"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",r,(0,o.v_)(u.inputButtonTooltip),1)])),_:1}),(0,n.bF)(g,{size:"x-large"},{default:(0,n.k6)((()=>t[3]||(t[3]=[(0,n.eW)("send")]))),_:1})])),_:1},8,["onClick","disabled"])):(0,n.Q3)("",!0),u.shouldShowSendButton||u.isModeLiveChat?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(m,(0,n.v6)({key:1,onClick:u.onMicClick},(0,n.Tb)(l.tooltipEventHandlers),{disabled:u.isMicButtonDisabled,ref:"mic",class:"icon-color input-button",icon:""}),{default:(0,n.k6)((()=>[(0,n.bF)(p,{activator:"parent",modelValue:l.shouldShowTooltip,"onUpdate:modelValue":t[1]||(t[1]=e=>l.shouldShowTooltip=e),location:"start"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",a,(0,o.v_)(u.inputButtonTooltip),1)])),_:1},8,["modelValue"]),(0,n.bF)(g,{size:"x-large"},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(u.micButtonIcon),1)])),_:1})])),_:1},16,["onClick","disabled"])),u.shouldShowUpload?((0,n.uX)(),(0,n.Wv)(m,{key:2,onClick:u.onPickFile,disabled:u.isLexProcessing,ref:"upload",class:"icon-color input-button",icon:""},{default:(0,n.k6)((()=>[(0,n.bF)(g,{size:"x-large"},{default:(0,n.k6)((()=>t[4]||(t[4]=[(0,n.eW)("attach_file")]))),_:1}),(0,n.Lk)("input",{type:"file",style:{display:"none"},ref:"fileInput",onChange:t[2]||(t[2]=(...e)=>u.onFilePicked&&u.onFilePicked(...e))},null,544)])),_:1},8,["onClick","disabled"])):(0,n.Q3)("",!0),l.shouldShowAttachmentClear?((0,n.uX)(),(0,n.Wv)(m,{key:3,onClick:u.onRemoveAttachments,disabled:u.isLexProcessing,ref:"removeAttachments",class:"icon-color input-button",icon:""},{default:(0,n.k6)((()=>[(0,n.bF)(g,{size:"x-large"},{default:(0,n.k6)((()=>t[5]||(t[5]=[(0,n.eW)("clear")]))),_:1})])),_:1},8,["onClick","disabled"])):(0,n.Q3)("",!0)])),_:1},8,["dense"]),t[6]||(t[6]=(0,n.Lk)("div",{class:"flex-center",hidden:""},[(0,n.Lk)("p",{class:"need-help"},[(0,n.eW)("Need More Help? Connect With Our "),(0,n.Lk)("a",{class:"support-link"},"Support Team")])],-1))],64)}s(81454);const l={class:"status-text"},u={class:"voice-controls ml-2"},d={key:0,class:"volume-meter"},h=["value"];function p(e,t,s,r,a,c){const p=(0,n.g2)("v-progress-linear"),g=(0,n.g2)("v-row");return(0,n.uX)(),(0,n.Wv)(g,{class:"recorder-status bg-white"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",l,[(0,n.Lk)("span",null,(0,o.v_)(c.statusText),1)]),(0,n.Lk)("div",u,[(0,n.bF)(i.Transition,{onEnter:c.enterMeter,onLeave:c.leaveMeter,css:!1},{default:(0,n.k6)((()=>[c.isRecording?((0,n.uX)(),(0,n.CE)("div",d,[(0,n.Lk)("meter",{value:a.volume,min:"0.0001",low:"0.005",optimum:"0.04",high:"0.07",max:"0.09"},null,8,h)])):(0,n.Q3)("",!0)])),_:1},8,["onEnter","onLeave"]),c.isProcessing?((0,n.uX)(),(0,n.Wv)(p,{key:0,indeterminate:!0,class:"processing-bar ma-0"})):(0,n.Q3)("",!0),(0,n.bF)(i.Transition,{onEnter:c.enterAudioPlay,onLeave:c.leaveAudioPlay,css:!1},{default:(0,n.k6)((()=>[c.isBotSpeaking?((0,n.uX)(),(0,n.Wv)(p,{key:0,modelValue:a.audioPlayPercent,"onUpdate:modelValue":t[0]||(t[0]=e=>a.audioPlayPercent=e),class:"audio-progress-bar ma-0"},null,8,["modelValue"])):(0,n.Q3)("",!0)])),_:1},8,["onEnter","onLeave"])])])),_:1})}const g={name:"recorder-status",data(){return{volume:0,volumeIntervalId:null,audioPlayPercent:0,audioIntervalId:null}},computed:{isSpeechConversationGoing(){return this.isConversationGoing},isProcessing(){return this.isSpeechConversationGoing&&!this.isRecording&&!this.isBotSpeaking},statusText(){return this.isInterrupting?"Interrupting...":this.canInterruptBotPlayback?'Say "skip" and I\'ll listen for your answer...':this.isMicMuted?"Microphone seems to be muted...":this.isRecording?"Listening...":this.isBotSpeaking?"Playing audio...":this.isSpeechConversationGoing?"Processing...":this.isRecorderSupported?"Click on the mic":""},canInterruptBotPlayback(){return this.$store.state.botAudio.canInterrupt},isBotSpeaking(){return this.$store.state.botAudio.isSpeaking},isConversationGoing(){return this.$store.state.recState.isConversationGoing},isInterrupting(){return this.$store.state.recState.isInterrupting||this.$store.state.botAudio.isInterrupting},isMicMuted(){return this.$store.state.recState.isMicMuted},isRecorderSupported(){return this.$store.state.recState.isRecorderSupported},isRecording(){return this.$store.state.recState.isRecording}},methods:{enterMeter(){const e=50;this.volumeIntervalId=setInterval((()=>{this.$store.dispatch("getRecorderVolume").then((e=>{this.volume=e.instant.toFixed(4)}))}),e)},leaveMeter(){this.volumeIntervalId&&clearInterval(this.volumeIntervalId)},enterAudioPlay(){const e=20;this.audioIntervalId=setInterval((()=>{this.$store.dispatch("getAudioProperties").then((({end:e=0,duration:t=0})=>{const s=t<=0?0:e/t*100;this.audioPlayPercent=10*Math.ceil(s/10)+5}))}),e)},leaveAudioPlay(){this.audioIntervalId&&(this.audioPlayPercent=0,clearInterval(this.audioIntervalId))}}};var m=s(66262);const v=(0,m.A)(g,[["render",p],["__scopeId","data-v-54f50400"]]),f=v;var b=s(96763);const y={name:"input-container",data(){return{textInput:"",isTextFieldFocused:!1,shouldShowTooltip:!1,shouldShowAttachmentClear:!1,tooltipEventHandlers:{mouseenter:this.onInputButtonHoverEnter,mouseleave:this.onInputButtonHoverLeave,touchstart:this.onInputButtonHoverEnter,touchend:this.onInputButtonHoverLeave,touchcancel:this.onInputButtonHoverLeave}}},props:["textInputPlaceholder","initialSpeechInstruction"],components:{RecorderStatus:f},computed:{isBotSpeaking(){return this.$store.state.botAudio.isSpeaking},isLexProcessing(){return this.$store.state.lex.isProcessing},isSpeechConversationGoing(){return this.$store.state.recState.isConversationGoing},isMicButtonDisabled(){return this.isMicMuted},isMicMuted(){return this.$store.state.recState.isMicMuted},isRecorderSupported(){return this.$store.state.recState.isRecorderSupported},isRecorderEnabled(){return this.$store.state.recState.isRecorderEnabled},isSendButtonDisabled(){return this.textInput.length<1},isModeLiveChat(){return"livechat"===this.$store.state.chatMode},micButtonIcon(){return this.isMicMuted?"mic_off":this.isBotSpeaking||this.isSpeechConversationGoing?"stop":"mic"},inputButtonTooltip(){return this.shouldShowSendButton?"send":this.isMicMuted?"mic seems to be muted":this.isBotSpeaking||this.isSpeechConversationGoing?"interrupt":"click to use voice"},shouldShowSendButton(){return this.textInput.length&&this.isTextFieldFocused||!this.isRecorderSupported||!this.isRecorderEnabled||this.isModeLiveChat},shouldShowTextInput(){return!(this.isBotSpeaking||this.isSpeechConversationGoing)},shouldShowUpload(){return this.$store.state.isLoggedIn&&this.$store.state.config.ui.uploadRequireLogin&&this.$store.state.config.ui.enableUpload||!this.$store.state.config.ui.uploadRequireLogin&&this.$store.state.config.ui.enableUpload}},methods:{onInputButtonHoverEnter(){this.shouldShowTooltip=!0},onInputButtonHoverLeave(){this.shouldShowTooltip=!1},onMicClick(){return this.onInputButtonHoverLeave(),this.isBotSpeaking||this.isSpeechConversationGoing?this.$store.dispatch("interruptSpeechConversation"):this.isSpeechConversationGoing?Promise.resolve():this.startSpeechConversation()},onTextFieldFocus(){this.isTextFieldFocused=!0},onTextFieldBlur(){!this.textInput.length&&this.isTextFieldFocused&&(this.isTextFieldFocused=!1)},onKeyUp(){this.$store.dispatch("sendTypingEvent")},setInputTextFieldFocus(){setTimeout((()=>{this.$refs&&this.$refs.textInput&&this.shouldShowTextInput&&this.$refs.textInput.focus()}),10)},playInitialInstruction(){const e=["","Fulfilled","Failed"].some((e=>this.$store.state.lex.dialogState===e));return e&&this.initialSpeechInstruction.length>0?this.$store.dispatch("pollySynthesizeInitialSpeech"):Promise.resolve()},postTextMessage(){if(this.onInputButtonHoverLeave(),this.textInput=this.textInput.trim(),!this.textInput.length)return Promise.resolve();const e={type:"human",text:this.textInput};if(this.$store.state.lex.sessionAttributes.userFilesUploaded){const t=JSON.parse(this.$store.state.lex.sessionAttributes.userFilesUploaded);e.attachements=t.map((function(e){return e.fileName})).toString()}if(this.$store.state.config.lex.allowStreamingResponses){const e=this.$store.state.config.lex.streamingWebSocketEndpoint.replace("wss://","https://");this.$store.dispatch("setSessionAttribute",{key:"streamingEndpoint",value:e}),this.$store.dispatch("setSessionAttribute",{key:"streamingDynamoDbTable",value:this.$store.state.config.lex.streamingDynamoDbTable})}return this.$store.dispatch("postTextMessage",e).then((()=>{this.textInput="",this.shouldShowTextInput&&this.setInputTextFieldFocus()}))},startSpeechConversation(){return this.isMicMuted?Promise.resolve():this.setAutoPlay().then((()=>this.playInitialInstruction())).then((()=>new Promise((function(e,t){setTimeout((()=>{e()}),100)})))).then((()=>this.$store.dispatch("startConversation"))).catch((e=>{b.error("error in startSpeechConversation",e);const t=this.$store.state.config.ui.showErrorDetails?` ${e}`:"";this.$store.dispatch("pushErrorMessage",`Sorry, I couldn't start the conversation. Please try again.${t}`)}))},setAutoPlay(){return this.$store.state.botAudio.autoPlay?Promise.resolve():this.$store.dispatch("setAudioAutoPlay")},onPickFile(){this.$refs.fileInput.click()},onFilePicked(e){const t=e.target.files;if(void 0!==t[0]){if(this.fileName=t[0].name,this.fileName.lastIndexOf(".")<=0)return;const e=new FileReader;e.readAsDataURL(t[0]),e.addEventListener("load",(()=>{this.fileObject=t[0],this.$store.dispatch("uploadFile",this.fileObject),this.shouldShowAttachmentClear=!0}))}else this.fileName="",this.fileObject=null},onRemoveAttachments(){delete this.$store.state.lex.sessionAttributes.userFilesUploaded,this.shouldShowAttachmentClear=!1}}},C=(0,m.A)(y,[["render",c]]),A=C},31934:(e,t,s)=>{"use strict";s.a(e,(async(e,n)=>{try{s.d(t,{A:()=>l});var i=s(51895),o=s(43515),r=(s(39029),s(66262)),a=e([o]);o=(a.then?(await a)():a)[0];const c=(0,r.A)(o.A,[["render",i.X]]),l=c;n()}catch(c){n(c)}}))},15156:(e,t,s)=>{"use strict";s.d(t,{A:()=>Y});var n=s(20641),i=s(90033);const o={"aria-live":"polite",class:"layout message-list column fill-height"};function r(e,t,s,r,a,c){const l=(0,n.g2)("message"),u=(0,n.g2)("MessageLoading");return(0,n.uX)(),(0,n.CE)("div",o,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(c.messages,(e=>((0,n.uX)(),(0,n.Wv)(l,{ref_for:!0,ref:"messages",message:e,key:e.id,class:(0,i.C4)(`message-${e.type}`),onScrollDown:c.scrollDown},null,8,["message","class","onScrollDown"])))),128)),c.loading?((0,n.uX)(),(0,n.Wv)(u,{key:0})):(0,n.Q3)("",!0)])}var a=s(53751);const c={key:1},l=["src"],u={class:"text-h5"},d={key:2},h=["src"],p={class:"text-h5"},g={key:3},m={class:"text-h5"},v={key:4},f={key:6,class:"feedback-state"},b={key:8},y=["src"],C={key:9,"offset-y":""};function A(e,t,s,o,r,A){const w=(0,n.g2)("message-text"),x=(0,n.g2)("v-card-title"),k=(0,n.g2)("v-img"),S=(0,n.g2)("v-avatar"),I=(0,n.g2)("v-divider"),T=(0,n.g2)("v-list-item"),M=(0,n.g2)("v-list"),L=(0,n.g2)("v-window-item"),E=(0,n.g2)("v-window"),_=(0,n.g2)("v-list-subheader"),P=(0,n.g2)("v-list-item-title"),$=(0,n.g2)("v-icon"),B=(0,n.g2)("v-btn"),R=(0,n.g2)("v-tooltip"),F=(0,n.g2)("v-menu"),O=(0,n.g2)("v-row"),D=(0,n.g2)("v-col"),U=(0,n.g2)("response-card");return(0,n.uX)(),(0,n.Wv)(O,{"d-flex":"",class:"message"},{default:(0,n.k6)((()=>[(0,n.bF)(D,{"ma-2":"",class:"message-layout"},{default:(0,n.k6)((()=>[(0,n.bF)(O,{"d-flex":"",class:"message-bubble-date-container"},{default:(0,n.k6)((()=>[(0,n.bF)(D,{class:"message-bubble-column"},{default:(0,n.k6)((()=>[(0,n.bF)(D,{"d-flex":"",class:"message-bubble-avatar-container"},{default:(0,n.k6)((()=>[(0,n.bF)(O,{class:(0,i.C4)(`message-bubble-row-${s.message.type}`)},{default:(0,n.k6)((()=>[A.shouldShowAvatarImage?((0,n.uX)(),(0,n.CE)("div",{key:0,style:(0,i.Tr)(A.avatarBackground),tabindex:"-1",class:"avatar","aria-hidden":"true"},null,4)):(0,n.Q3)("",!0),(0,n.Lk)("div",{tabindex:"0",onFocus:t[5]||(t[5]=(...e)=>A.onMessageFocus&&A.onMessageFocus(...e)),onBlur:t[6]||(t[6]=(...e)=>A.onMessageBlur&&A.onMessageBlur(...e)),class:(0,i.C4)(["message-bubble focusable",`message-bubble-row-${s.message.type}`])},["text"in s.message&&null!==s.message.text&&s.message.text.length&&!A.shouldDisplayInteractiveMessage?((0,n.uX)(),(0,n.Wv)(w,{key:0,message:s.message},null,8,["message"])):(0,n.Q3)("",!0),A.shouldDisplayInteractiveMessage&&"ListPicker"==r.interactiveMessage?.templateType?((0,n.uX)(),(0,n.CE)("div",c,[(0,n.bF)(x,{"primary-title":""},{default:(0,n.k6)((()=>[(0,n.Lk)("div",null,[(0,n.Lk)("img",{src:r.interactiveMessage?.data.content.imageData},null,8,l),(0,n.Lk)("div",u,(0,i.v_)(r.interactiveMessage.data.content.title),1),(0,n.Lk)("span",null,(0,i.v_)(r.interactiveMessage?.data.content.subtitle),1)])])),_:1}),(0,n.bF)(M,{density:"compact",lines:"two",class:"message-bubble interactive-row"},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.interactiveMessage?.data.content.elements,((e,t)=>((0,n.uX)(),(0,n.Wv)(T,{key:t,subtitle:e.subtitle,title:e.title,onClick:t=>A.resendMessage(e.title)},(0,n.eX)({default:(0,n.k6)((()=>[(0,n.bF)(I)])),_:2},[e.imageData?{name:"prepend",fn:(0,n.k6)((()=>[(0,n.bF)(S,null,{default:(0,n.k6)((()=>[(0,n.bF)(k,{src:e.imageData},null,8,["src"])])),_:2},1024)])),key:"0"}:void 0]),1032,["subtitle","title","onClick"])))),128))])),_:1})])):(0,n.Q3)("",!0),A.shouldDisplayInteractiveMessage&&"Carousel"==r.interactiveMessage?.templateType?((0,n.uX)(),(0,n.CE)("div",d,[(0,n.bF)(E,{"show-arrows":""},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.interactiveMessage?.data.content.elements,((e,t)=>((0,n.uX)(),(0,n.Wv)(L,{key:t},{default:(0,n.k6)((()=>[(0,n.bF)(x,{"primary-title":""},{default:(0,n.k6)((()=>[(0,n.Lk)("div",null,[(0,n.Lk)("img",{src:e.imageData},null,8,h),(0,n.Lk)("div",p,(0,i.v_)(e.title),1),(0,n.Lk)("span",null,(0,i.v_)(e.subtitle),1)])])),_:2},1024),(0,n.bF)(M,{density:"compact",lines:"two",class:"message-bubble interactive-row"},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.data.content.elements,((e,t)=>((0,n.uX)(),(0,n.Wv)(T,{key:t,subtitle:e.subtitle,title:e.title,onClick:t=>A.resendMessage(e.title)},(0,n.eX)({default:(0,n.k6)((()=>[(0,n.bF)(I)])),_:2},[e.imageData?{name:"prepend",fn:(0,n.k6)((()=>[(0,n.bF)(S,null,{default:(0,n.k6)((()=>[(0,n.bF)(k,{src:e.imageData},null,8,["src"])])),_:2},1024)])),key:"0"}:void 0]),1032,["subtitle","title","onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1})])):(0,n.Q3)("",!0),A.shouldDisplayInteractiveMessage&&"TimePicker"==r.interactiveMessage?.templateType?((0,n.uX)(),(0,n.CE)("div",g,[(0,n.bF)(x,{"primary-title":""},{default:(0,n.k6)((()=>[(0,n.Lk)("div",null,[(0,n.Lk)("div",m,(0,i.v_)(r.interactiveMessage?.data.content.title),1),(0,n.Lk)("span",null,(0,i.v_)(r.interactiveMessage?.data.content.subtitle),1)])])),_:1}),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(A.sortedTimeslots,(e=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(_,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(e.date),1)])),_:2},1024),(0,n.bF)(M,{lines:"two",class:"message-bubble interactive-row"},{default:(0,n.k6)((()=>[(0,n.bF)(T,null,{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.slots,(e=>((0,n.uX)(),(0,n.Wv)(T,{key:e.localTime,data:e,onClick:t=>A.resendMessage(e.date)},{default:(0,n.k6)((()=>[(0,n.bF)(P,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(e.localTime),1)])),_:2},1024)])),_:2},1032,["data","onClick"])))),128))])),_:2},1024)])),_:2},1024)],64)))),256))])):(0,n.Q3)("",!0),A.shouldDisplayInteractiveMessage&&"QuickReply"==r.interactiveMessage.templateType?((0,n.uX)(),(0,n.CE)("div",v,[(0,n.bF)(w,{message:{text:r.interactiveMessage?.data.content.title,type:"bot"}},null,8,["message"])])):(0,n.Q3)("",!0),"bot"===s.message.type&&s.message.id!==e.$store.state.messages[0].id&&A.showCopyIcon?((0,n.uX)(),(0,n.Wv)($,{key:5,class:"copy-icon",onClick:t[0]||(t[0]=e=>A.copyMessageToClipboard(s.message.text))},{default:(0,n.k6)((()=>t[7]||(t[7]=[(0,n.eW)(" content_copy ")]))),_:1})):(0,n.Q3)("",!0),s.message.id===this.$store.state.messages.length-1&&A.isLastMessageFeedback&&"bot"===s.message.type&&A.botDialogState&&A.showDialogFeedback?((0,n.uX)(),(0,n.CE)("div",f,[(0,n.bF)($,{onClick:t[1]||(t[1]=e=>A.onButtonClick(r.positiveIntent)),class:(0,i.C4)({"feedback-icons-positive":!r.positiveClick,positiveClick:r.positiveClick}),tabindex:"0",size:"small"},{default:(0,n.k6)((()=>t[8]||(t[8]=[(0,n.eW)(" thumb_up ")]))),_:1},8,["class"]),(0,n.bF)($,{onClick:t[2]||(t[2]=e=>A.onButtonClick(r.negativeIntent)),class:(0,i.C4)({"feedback-icons-negative":!r.negativeClick,negativeClick:r.negativeClick}),tabindex:"0",size:"small"},{default:(0,n.k6)((()=>t[9]||(t[9]=[(0,n.eW)(" thumb_down ")]))),_:1},8,["class"])])):(0,n.Q3)("",!0),"bot"===s.message.type&&A.botDialogState&&A.showDialogStateIcon?((0,n.uX)(),(0,n.Wv)($,{key:7,size:"medium",class:(0,i.C4)([`dialog-state-${A.botDialogState.state}`,"dialog-state"])},{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(A.botDialogState.icon),1)])),_:1},8,["class"])):(0,n.Q3)("",!0),"human"===s.message.type&&s.message.audio?((0,n.uX)(),(0,n.CE)("div",b,[(0,n.Lk)("audio",null,[(0,n.Lk)("source",{src:s.message.audio,type:"audio/wav"},null,8,y)]),(0,n.bo)((0,n.bF)(B,{onClick:A.playAudio,tabindex:"0",icon:"",class:"icon-color ml-0 mr-0"},{default:(0,n.k6)((()=>[(0,n.bF)($,{class:"play-icon"},{default:(0,n.k6)((()=>t[10]||(t[10]=[(0,n.eW)("play_circle_outline")]))),_:1})])),_:1},8,["onClick"]),[[a.vShow,!A.showMessageMenu]])])):(0,n.Q3)("",!0),A.shouldShowAttachments?((0,n.uX)(),(0,n.CE)("div",C,[(0,n.bF)(B,(0,n.v6)({class:`tooltip-attachments-${s.message.id}`},(0,n.Tb)(r.attachmentEventHandlers),{icon:""}),{default:(0,n.k6)((()=>[(0,n.bF)($,{size:"medium"},{default:(0,n.k6)((()=>t[11]||(t[11]=[(0,n.eW)(" attach_file ")]))),_:1})])),_:1},16,["class"]),(0,n.bF)(R,{modelValue:r.showAttachmentsTooltip,"onUpdate:modelValue":t[3]||(t[3]=e=>r.showAttachmentsTooltip=e),activator:`.tooltip-attachments-${s.message.id}`,"content-class":"tooltip-custom",location:"left"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",null,(0,i.v_)(s.message.attachements),1)])),_:1},8,["modelValue","activator"])])):(0,n.Q3)("",!0),"human"===s.message.type?(0,n.bo)(((0,n.uX)(),(0,n.Wv)(F,{key:10},{default:(0,n.k6)((()=>[(0,n.bF)(B,{slot:"activator",icon:""},{default:(0,n.k6)((()=>[(0,n.bF)($,{class:"smicon"},{default:(0,n.k6)((()=>t[12]||(t[12]=[(0,n.eW)(" more_vert ")]))),_:1})])),_:1}),(0,n.bF)(M,null,{default:(0,n.k6)((()=>[(0,n.bF)(T,null,{default:(0,n.k6)((()=>[(0,n.bF)(P,{onClick:t[4]||(t[4]=e=>A.resendMessage(s.message.text))},{default:(0,n.k6)((()=>[(0,n.bF)($,null,{default:(0,n.k6)((()=>t[13]||(t[13]=[(0,n.eW)("replay")]))),_:1})])),_:1})])),_:1}),"human"===s.message.type&&s.message.audio?((0,n.uX)(),(0,n.Wv)(T,{key:0,class:"message-audio"},{default:(0,n.k6)((()=>[(0,n.bF)(P,{onClick:A.playAudio},{default:(0,n.k6)((()=>[(0,n.bF)($,null,{default:(0,n.k6)((()=>t[14]||(t[14]=[(0,n.eW)("play_circle_outline")]))),_:1})])),_:1},8,["onClick"])])),_:1})):(0,n.Q3)("",!0)])),_:1})])),_:1},512)),[[a.vShow,A.showMessageMenu]]):(0,n.Q3)("",!0)],34)])),_:1},8,["class"])])),_:1}),A.shouldShowMessageDate&&r.isMessageFocused?((0,n.uX)(),(0,n.Wv)(D,{key:0,class:(0,i.C4)(`text-xs-center message-date-${s.message.type}`),"aria-hidden":"true"},{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(r.messageHumanDate),1)])),_:1},8,["class"])):(0,n.Q3)("",!0)])),_:1})])),_:1}),A.shouldDisplayResponseCard?((0,n.uX)(),(0,n.Wv)(O,{key:0,class:"response-card","d-flex":"","mt-2":"","mr-2":"","ml-3":""},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.message.responseCard.genericAttachments,((e,t)=>((0,n.uX)(),(0,n.Wv)(U,{"response-card":e,key:t},null,8,["response-card"])))),128))])),_:1})):(0,n.Q3)("",!0),A.shouldDisplayInteractiveMessage&&"QuickReply"==r.interactiveMessage?.templateType?((0,n.uX)(),(0,n.Wv)(O,{key:1,class:"response-card","d-flex":"","mt-2":"","mr-2":"","ml-3":""},{default:(0,n.k6)((()=>[((0,n.uX)(),(0,n.Wv)(U,{"response-card":A.quickReplyResponseCard,key:e.index},null,8,["response-card"]))])),_:1})):(0,n.Q3)("",!0),A.shouldDisplayResponseCardV2&&!A.shouldDisplayResponseCard?((0,n.uX)(),(0,n.Wv)(O,{key:2},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.message.responseCardsLexV2,((e,t)=>((0,n.uX)(),(0,n.Wv)(O,{class:"response-card","d-flex":"","mt-2":"","mr-2":"","ml-3":"",key:t},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.genericAttachments,((e,t)=>((0,n.uX)(),(0,n.Wv)(U,{"response-card":e,key:t},null,8,["response-card"])))),128))])),_:2},1024)))),128))])),_:1})):(0,n.Q3)("",!0)])),_:1})])),_:1})}s(44114),s(98992),s(3949);const w={key:0,class:"message-text"},x=["innerHTML"],k=["innerHTML"],S={key:3,class:"message-text bot-message-plain"},I={class:"sr-only"};function T(e,t,s,o,r,a){return!s.message.text||"human"!==s.message.type&&"feedback"!==s.message.type?a.altHtmlMessage&&a.AllowSuperDangerousHTMLInMessage?((0,n.uX)(),(0,n.CE)("div",{key:1,innerHTML:a.altHtmlMessage,class:"message-text"},null,8,x)):s.message.text&&a.shouldRenderAsHtml?((0,n.uX)(),(0,n.CE)("div",{key:2,innerHTML:a.botMessageAsHtml,class:"message-text"},null,8,k)):!s.message.text||"bot"!==s.message.type&&"agent"!==s.message.type?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",S,[(0,n.Lk)("span",I,(0,i.v_)(s.message.type)+" says: ",1),(0,n.eW)((0,i.v_)(a.shouldStripTags?a.stripTagsFromMessage(s.message.text):s.message.text),1)])):((0,n.uX)(),(0,n.CE)("div",w,[t[0]||(t[0]=(0,n.Lk)("span",{class:"sr-only"},"I say: ",-1)),(0,n.eW)((0,i.v_)(s.message.text),1)]))}s(8872);const M=s(6709),L={link:function(e,t,s){return`<a href="${e}" title="${t}" target="_blank">${s}</a>`}};M.use({renderer:L});const E={name:"message-text",props:["message"],computed:{shouldConvertUrlToLinks(){return this.$store.state.config.ui.convertUrlToLinksInBotMessages},shouldStripTags(){return this.$store.state.config.ui.stripTagsFromBotMessages},AllowSuperDangerousHTMLInMessage(){return this.$store.state.config.ui.AllowSuperDangerousHTMLInMessage},altHtmlMessage(){let e=!1;return this.message.alts&&(this.message.alts.html?e=this.message.alts.html:this.message.alts.markdown&&(e=M.parse(this.message.alts.markdown))),e&&(e=this.prependBotScreenReader(e)),e},shouldRenderAsHtml(){return["bot","agent"].includes(this.message.type)&&this.shouldConvertUrlToLinks},botMessageAsHtml(){const e=this.stripTagsFromMessage(this.message.text),t=this.botMessageWithLinks(e),s=this.prependBotScreenReader(t);return s}},methods:{encodeAsHtml(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},botMessageWithLinks(e){const t=[{type:"web",regex:new RegExp("\\b((?:https?://\\w{1}|www\\.)(?:[\\w-.]){2,256}(?:[\\w._~:/?#@!$&()*+,;=['\\]-]){0,256})","im"),replace:e=>{const t=/^https?:\/\//.test(e)?e:`http://${e}`;return`<a target="_blank" href="${encodeURI(t)}">${this.encodeAsHtml(e)}</a>`}}];return t.reduce(((e,t)=>e.split(t.regex).reduce(((e,s,n,i)=>{let o="";if(n%2===0){const e=n+1===i.length?"":t.replace(i[n+1]);o=`${this.encodeAsHtml(s)}${e}`}return e+o}),"")),e)},stripTagsFromMessage(e){const t=document.implementation.createHTMLDocument("").body;return t.innerHTML=e,t.textContent||t.innerText||""},prependBotScreenReader(e){return`<span class="sr-only">bot says: </span>${e}`}}};var _=s(66262);const P=(0,_.A)(E,[["render",T],["__scopeId","data-v-56991e33"]]),$=P,B={key:0},R={class:"text-h5"};function F(e,t,s,o,r,c){const l=(0,n.g2)("v-card-title"),u=(0,n.g2)("v-card-text"),d=(0,n.g2)("v-img"),h=(0,n.g2)("v-btn"),p=(0,n.g2)("v-card-actions"),g=(0,n.g2)("v-card");return(0,n.uX)(),(0,n.Wv)(g,{flat:""},{default:(0,n.k6)((()=>[c.shouldDisplayResponseCardTitle?((0,n.uX)(),(0,n.CE)("div",B,[e.responseCard.title&&e.responseCard.title.trim()?((0,n.uX)(),(0,n.Wv)(l,{key:0,"primary-title":"",class:"bg-red-lighten-5"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",R,(0,i.v_)(e.responseCard.title),1)])),_:1})):(0,n.Q3)("",!0)])):(0,n.Q3)("",!0),e.responseCard.subTitle?((0,n.uX)(),(0,n.Wv)(u,{key:1},{default:(0,n.k6)((()=>[(0,n.Lk)("span",null,(0,i.v_)(e.responseCard.subTitle),1)])),_:1})):(0,n.Q3)("",!0),e.responseCard.subtitle?((0,n.uX)(),(0,n.Wv)(u,{key:2},{default:(0,n.k6)((()=>[(0,n.Lk)("span",null,(0,i.v_)(e.responseCard.subtitle),1)])),_:1})):(0,n.Q3)("",!0),e.responseCard.imageUrl?((0,n.uX)(),(0,n.Wv)(d,{key:3,src:e.responseCard.imageUrl,contain:"",height:"33vh"},null,8,["src"])):(0,n.Q3)("",!0),e.responseCard.buttons?((0,n.uX)(),(0,n.Wv)(p,{key:4,class:"button-row"},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.responseCard.buttons,(e=>(0,n.bo)(((0,n.uX)(),(0,n.Wv)(h,{key:e.id,disabled:c.shouldDisableClickedResponseCardButtons,class:(0,i.C4)("more"===e.text.toLowerCase()?"":"bg-accent"),rounded:"xl",variant:1==c.shouldDisableClickedResponseCardButtons?"":"elevated",onClickOnce:t=>c.onButtonClick(e.value)},{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(e.text),1)])),_:2},1032,["disabled","class","variant","onClickOnce"])),[[a.vShow,e.text&&e.value]]))),128))])),_:1})):(0,n.Q3)("",!0),e.responseCard.attachmentLinkUrl?((0,n.uX)(),(0,n.Wv)(p,{key:5},{default:(0,n.k6)((()=>[(0,n.bF)(h,{variant:"flat",class:"bg-red-lighten-5",tag:"a",href:e.responseCard.attachmentLinkUrl,target:"_blank"},{default:(0,n.k6)((()=>t[0]||(t[0]=[(0,n.eW)(" Open Link ")]))),_:1},8,["href"])])),_:1})):(0,n.Q3)("",!0)])),_:1})}const O={name:"response-card",props:["response-card"],data(){return{hasButtonBeenClicked:!1}},computed:{shouldDisplayResponseCardTitle(){return this.$store.state.config.ui.shouldDisplayResponseCardTitle},shouldDisableClickedResponseCardButtons(){return this.$store.state.config.ui.shouldDisableClickedResponseCardButtons&&(this.hasButtonBeenClicked||this.getRCButtonsDisabled())}},inject:["getRCButtonsDisabled","setRCButtonsDisabled"],methods:{onButtonClick(e){this.hasButtonBeenClicked=!0,this.setRCButtonsDisabled();const t=this.$store.state.config.ui.hideButtonMessageBubble?"button":"human",s={type:t,text:e};this.$store.dispatch("postTextMessage",s)}}},D=(0,_.A)(O,[["render",F],["__scopeId","data-v-d2979826"]]),U=D;var W=s(96763);const N={name:"message",props:["message","feedback"],components:{MessageText:$,ResponseCard:U},data(){return{isMessageFocused:!1,messageHumanDate:"Now",datetime:new Date,textFieldProps:{appendIcon:"event"},positiveClick:!1,negativeClick:!1,hasButtonBeenClicked:!1,disableCardButtons:!1,interactiveMessage:null,positiveIntent:this.$store.state.config.ui.positiveFeedbackIntent,negativeIntent:this.$store.state.config.ui.negativeFeedbackIntent,hideInputFields:this.$store.state.config.ui.hideInputFieldsForButtonResponse,showAttachmentsTooltip:!1,attachmentEventHandlers:{mouseenter:this.mouseOverAttachment,mouseleave:this.mouseOverAttachment,touchstart:this.mouseOverAttachment,touchend:this.mouseOverAttachment,touchcancel:this.mouseOverAttachment}}},computed:{botDialogState(){if(!("dialogState"in this.message))return null;switch(this.message.dialogState){case"Failed":return{icon:"error",color:"red",state:"fail"};case"Fulfilled":case"ReadyForFulfillment":return{icon:"done",color:"green",state:"ok"};default:return null}},isLastMessageFeedback(){return this.$store.state.messages.length>2&&"feedback"!==this.$store.state.messages[this.$store.state.messages.length-2].type},botAvatarUrl(){return this.$store.state.config.ui.avatarImageUrl},agentAvatarUrl(){return this.$store.state.config.ui.agentAvatarImageUrl},showDialogStateIcon(){return this.$store.state.config.ui.showDialogStateIcon},showCopyIcon(){return this.$store.state.config.ui.showCopyIcon},showMessageMenu(){return this.$store.state.config.ui.messageMenu},showDialogFeedback(){return this.$store.state.config.ui.positiveFeedbackIntent.length>2&&this.$store.state.config.ui.negativeFeedbackIntent.length>2},showErrorIcon(){return this.$store.state.config.ui.showErrorIcon},shouldDisplayResponseCard(){return this.message.responseCard&&("1"===this.message.responseCard.version||1===this.message.responseCard.version)&&"application/vnd.amazonaws.card.generic"===this.message.responseCard.contentType&&"genericAttachments"in this.message.responseCard&&this.message.responseCard.genericAttachments instanceof Array},shouldDisplayResponseCardV2(){return"isLastMessageInGroup"in this.message&&"true"===this.message.isLastMessageInGroup&&this.message.responseCardsLexV2&&this.message.responseCardsLexV2.length>0},shouldDisplayInteractiveMessage(){try{return this.interactiveMessage=JSON.parse(this.message.text),this.interactiveMessage.hasOwnProperty("templateType")}catch(e){return!1}},sortedTimeslots(){if("TimePicker"==this.interactiveMessage?.templateType){var e=this.interactiveMessage.data.content.timeslots.sort(((e,t)=>e.date.localeCompare(t.date)));const n={weekday:"long",month:"long",day:"numeric"},i={hour:"numeric",minute:"numeric",timeZoneName:"short"},o=localStorage.getItem("selectedLocale")?localStorage.getItem("selectedLocale"):this.$store.state.config.lex.v2BotLocaleId.split(",")[0];var t=(o||"en-US").replace("_","-"),s=[];return e.forEach((function(e,o){e.localTime=new Date(e.date).toLocaleTimeString(t,i);const r=new Date(e.date).setHours(0,0,0,0),a=new Date(r).toLocaleDateString(t,n);let c=s.find((e=>e.date===a));if(c)c.slots.push(e);else{var l={date:a,slots:[e]};s.push(l)}})),s}},quickReplyResponseCard(){if("QuickReply"==this.interactiveMessage?.templateType){var e={buttons:[]};return this.interactiveMessage.data.content.elements.forEach((function(t,s){e.buttons.push({text:t.title,value:t.title})})),e}},shouldShowAvatarImage(){return"bot"===this.message.type?this.botAvatarUrl:"agent"===this.message.type&&this.agentAvatarUrl},avatarBackground(){const e="bot"===this.message.type?this.botAvatarUrl:this.agentAvatarUrl;return{background:`url(${e}) center center / contain no-repeat`}},shouldShowMessageDate(){return this.$store.state.config.ui.showMessageDate},shouldShowAttachments(){return!("human"!==this.message.type||!this.message.attachements)}},provide:function(){return{getRCButtonsDisabled:this.getRCButtonsDisabled,setRCButtonsDisabled:this.setRCButtonsDisabled}},methods:{setRCButtonsDisabled:function(){this.disableCardButtons=!0},getRCButtonsDisabled:function(){return this.disableCardButtons},resendMessage(e){const t={type:"human",text:e};this.$store.dispatch("postTextMessage",t)},sendDateTime(e){const t={type:"human",text:e.toLocaleString()};this.$store.dispatch("postTextMessage",t)},onButtonClick(e){if(!this.hasButtonBeenClicked){this.hasButtonBeenClicked=!0,e===this.$store.state.config.ui.positiveFeedbackIntent?this.positiveClick=!0:this.negativeClick=!0;const t={type:"feedback",text:e};this.$emit("feedbackButton"),this.$store.dispatch("postTextMessage",t)}},playAudio(){const e=this.$el.querySelector("audio");e&&e.play()},onMessageFocus(){this.shouldShowMessageDate&&(this.messageHumanDate=this.getMessageHumanDate(),this.isMessageFocused=!0,this.message.id===this.$store.state.messages.length-1&&this.$emit("scrollDown"))},mouseOverAttachment(){this.showAttachmentsTooltip=!this.showAttachmentsTooltip},onMessageBlur(){this.shouldShowMessageDate&&(this.isMessageFocused=!1)},getMessageHumanDate(){const e=Math.round((new Date-this.message.date)/1e3),t=3600,s=24*t;return e<60?"Now":e<t?`${Math.floor(e/60)} min ago`:e<s?this.message.date.toLocaleTimeString():this.message.date.toLocaleString()},copyMessageToClipboard(e){navigator.clipboard.writeText(e).then((()=>{W.log("Message copied to clipboard.")})).catch((e=>{W.error("Failed to copy text: ",e)}))}},created(){this.message.responseCard&&"genericAttachments"in this.message.responseCard?this.message.responseCard.genericAttachments[0].buttons&&this.hideInputFields&&!this.$store.state.hasButtons&&this.$store.dispatch("toggleHasButtons"):this.$store.state.config.ui.hideInputFieldsForButtonResponse&&this.$store.state.hasButtons&&this.$store.dispatch("toggleHasButtons")}},H=(0,_.A)(N,[["render",A],["__scopeId","data-v-35d810b8"]]),V=H,j={class:"message-bubble","aria-hidden":"true"};function X(e,t,s,o,r,a){const c=(0,n.g2)("v-row"),l=(0,n.g2)("v-col");return(0,n.uX)(),(0,n.Wv)(c,{"d-flex":"",class:"message message-bot messsge-loading","aria-hidden":"true"},{default:(0,n.k6)((()=>[(0,n.bF)(l,{"ma-2":"",class:"message-layout"},{default:(0,n.k6)((()=>[(0,n.bF)(c,{"d-flex":"",class:"message-bubble-date-container"},{default:(0,n.k6)((()=>[(0,n.bF)(l,{class:"message-bubble-column"},{default:(0,n.k6)((()=>[(0,n.bF)(l,{"d-flex":"",class:"message-bubble-avatar-container"},{default:(0,n.k6)((()=>[(0,n.bF)(c,{class:"message-bubble-row"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",j,(0,i.v_)(e.$store.state.config.lex.allowStreamingResponses?e.$store.state.streaming.wsMessagesString:r.progress),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}const z={name:"messageLoading",data(){return{progress:"."}},computed:{isStartingTypingWsMessages(){return this.$store.getters.isStartingTypingWsMessages()}},methods:{},created(){this.interval=setInterval((()=>{this.progress.length>2?this.progress=".":this.progress+="."}),500)},unmounted(){clearInterval(this.interval)}},q=(0,_.A)(z,[["render",X],["__scopeId","data-v-3f73af04"]]),Q=q,G={name:"message-list",components:{Message:V,MessageLoading:Q},computed:{messages(){return this.$store.state.messages},loading(){return this.$store.state.lex.isProcessing||this.$store.state.liveChat.isProcessing}},watch:{messages:{handler(e,t){this.scrollDown()},deep:!0},loading(){this.scrollDown()}},mounted(){setTimeout((()=>{this.scrollDown()}),1e3)},methods:{scrollDown(){return this.$nextTick((()=>{if(this.$el.lastElementChild){this.$el.lastElementChild.getBoundingClientRect().height,this.$el.lastElementChild.classList.contains("messsge-loading");this.$el.scrollTop=this.$el.scrollHeight}}))}}},J=(0,_.A)(G,[["render",r],["__scopeId","data-v-f6e82dae"]]),Y=J},10352:(e,t,s)=>{"use strict";s.d(t,{A:()=>u});var n=s(20641),i=s(53751),o=s(90033);function r(e,t,s,r,a,c){const l=(0,n.g2)("v-btn"),u=(0,n.g2)("v-fab-transition"),d=(0,n.g2)("v-col"),h=(0,n.g2)("v-row"),p=(0,n.g2)("v-container");return(0,n.uX)(),(0,n.Wv)(p,{fluid:"",class:"pa-0 min-button-container"},{default:(0,n.k6)((()=>[(0,n.bF)(h,{justify:"end"},{default:(0,n.k6)((()=>[(0,n.bF)(d,{cols:"auto"},{default:(0,n.k6)((()=>[(0,n.bF)(u,null,{default:(0,n.k6)((()=>[c.minButtonContent?(0,n.bo)(((0,n.uX)(),(0,n.Wv)(l,(0,n.v6)({key:0,rounded:"xl",size:"x-large",color:s.toolbarColor,onClick:(0,i.withModifiers)(c.toggleMinimize,["stop"])},(0,n.Tb)(a.tooltipEventHandlers),{"aria-label":"show chat window",class:"min-button min-button-content","prepend-icon":"chat"}),{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(c.minButtonContent),1)])),_:1},16,["color","onClick"])),[[i.vShow,s.isUiMinimized]]):(0,n.bo)(((0,n.uX)(),(0,n.Wv)(l,(0,n.v6)({key:1,icon:"chat",size:"x-large",color:s.toolbarColor,onClick:(0,i.withModifiers)(c.toggleMinimize,["stop"])},(0,n.Tb)(a.tooltipEventHandlers),{"aria-label":"show chat window",class:"min-button"}),null,16,["color","onClick"])),[[i.vShow,s.isUiMinimized]])])),_:1})])),_:1})])),_:1})])),_:1})}const a={name:"min-button",data(){return{shouldShowTooltip:!1,tooltipEventHandlers:{mouseenter:this.onInputButtonHoverEnter,mouseleave:this.onInputButtonHoverLeave,touchstart:this.onInputButtonHoverEnter,touchend:this.onInputButtonHoverLeave,touchcancel:this.onInputButtonHoverLeave}}},props:["toolbarColor","isUiMinimized"],computed:{toolTipMinimize(){return this.isUiMinimized?"maximize":"minimize"},minButtonContent(){const e=this.$store.state.config.ui.minButtonContent.length;return e>1&&this.$store.state.config.ui.minButtonContent}},methods:{onInputButtonHoverEnter(){this.shouldShowTooltip=!0},onInputButtonHoverLeave(){this.shouldShowTooltip=!1},toggleMinimize(){this.$store.state.isRunningEmbedded&&(this.onInputButtonHoverLeave(),this.$emit("toggleMinimizeUi"))}}};var c=s(66262);const l=(0,c.A)(a,[["render",r]]),u=l},24667:(e,t,s)=>{"use strict";s.a(e,(async(e,n)=>{try{s.d(t,{A:()=>l});var i=s(46098),o=s(12806),r=(s(7457),s(66262)),a=e([o]);o=(a.then?(await a)():a)[0];const c=(0,r.A)(o.A,[["render",i.X]]),l=c;n()}catch(c){n(c)}}))},39029:()=>{},7457:()=>{},43515:(e,t,s)=>{"use strict";s.a(e,(async(e,n)=>{try{s.d(t,{A:()=>i.A});var i=s(74880),o=e([i]);i=(o.then?(await o)():o)[0],n()}catch(r){n(r)}}))},12806:(e,t,s)=>{"use strict";s.a(e,(async(e,n)=>{try{s.d(t,{A:()=>i.A});var i=s(52093),o=e([i]);i=(o.then?(await o)():o)[0],n()}catch(r){n(r)}}))},51895:(e,t,s)=>{"use strict";s.d(t,{X:()=>r});var n=s(20641),i=s(90033);const o={key:2,id:"sound","aria-hidden":"true"};function r(e,t,s,r,a,c){const l=(0,n.g2)("min-button"),u=(0,n.g2)("message-list"),d=(0,n.g2)("v-container"),h=(0,n.g2)("v-main"),p=(0,n.g2)("input-container"),g=(0,n.g2)("v-app");return(0,n.uX)(),(0,n.Wv)(g,{id:"lex-web","ui-minimized":c.isUiMinimized},{default:(0,n.k6)((()=>[(0,n.bF)(l,{"toolbar-color":c.toolbarColor,"is-ui-minimized":c.isUiMinimized,onToggleMinimizeUi:c.toggleMinimizeUi},null,8,["toolbar-color","is-ui-minimized","onToggleMinimizeUi"]),c.isUiMinimized?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(h,{key:0},{default:(0,n.k6)((()=>[(0,n.bF)(d,{class:(0,i.C4)(["message-list-container",`toolbar-height-${a.toolbarHeightClassSuffix}`]),fluid:"","pa-0":""},{default:(0,n.k6)((()=>[c.isUiMinimized?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(u,{key:0}))])),_:1},8,["class"])])),_:1})),c.isUiMinimized||c.hasButtons?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(p,{key:1,ref:"InputContainer","text-input-placeholder":c.textInputPlaceholder,"initial-speech-instruction":c.initialSpeechInstruction},null,8,["text-input-placeholder","initial-speech-instruction"])),c.isSFXOn?((0,n.uX)(),(0,n.CE)("div",o)):(0,n.Q3)("",!0)])),_:1},8,["ui-minimized"])}},46098:(e,t,s)=>{"use strict";s.d(t,{X:()=>h});var n=s(20641),i=s(90033),o=s(53751);const r=["src"],a={class:"nav-buttons"},c={id:"min-max-tooltip"},l={id:"end-live-chat-tooltip"},u={key:2,class:"localeInfo"},d={class:"hangup-text"};function h(e,t,s,h,p,g){const m=(0,n.g2)("v-btn"),v=(0,n.g2)("v-icon"),f=(0,n.g2)("v-list-item-title"),b=(0,n.g2)("v-list-item"),y=(0,n.g2)("v-list"),C=(0,n.g2)("v-menu"),A=(0,n.g2)("v-tooltip"),w=(0,n.g2)("v-toolbar-title"),x=(0,n.g2)("v-toolbar");return s.isUiMinimized?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(x,{key:0,elevation:"3",color:s.toolbarColor,onClick:g.toolbarClickHandler,density:g.density,class:(0,i.C4)({minimized:s.isUiMinimized}),"aria-label":"Toolbar with sound FX mute button, minimise chat window button and option chat back a step button"},{default:(0,n.k6)((()=>[s.toolbarLogo?((0,n.uX)(),(0,n.CE)("img",{key:0,class:"toolbar-image",src:s.toolbarLogo,alt:"logo","aria-hidden":"true"},null,8,r)):(0,n.Q3)("",!0),g.showToolbarMenu?((0,n.uX)(),(0,n.Wv)(C,{key:1},{activator:(0,n.k6)((({props:e})=>[(0,n.bo)((0,n.bF)(m,(0,n.v6)(e,(0,n.Tb)(p.tooltipMenuEventHandlers),{class:"menu",icon:"menu",size:"small","aria-label":"menu options"}),null,16),[[o.vShow,!s.isUiMinimized]])])),default:(0,n.k6)((()=>[(0,n.bF)(y,null,{default:(0,n.k6)((()=>[g.isEnableLogin?((0,n.uX)(),(0,n.Wv)(b,{key:0},{default:(0,n.k6)((()=>[g.isLoggedIn?((0,n.uX)(),(0,n.Wv)(f,{key:0,onClick:g.requestLogout,"aria-label":"logout"},{default:(0,n.k6)((()=>[(0,n.bF)(v,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(p.items[1].icon),1)])),_:1}),(0,n.eW)(" "+(0,i.v_)(p.items[1].title),1)])),_:1},8,["onClick"])):(0,n.Q3)("",!0),g.isLoggedIn?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(f,{key:1,onClick:g.requestLogin,"aria-label":"login"},{default:(0,n.k6)((()=>[(0,n.bF)(v,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(p.items[0].icon),1)])),_:1}),(0,n.eW)(" "+(0,i.v_)(p.items[0].title),1)])),_:1},8,["onClick"]))])),_:1})):(0,n.Q3)("",!0),g.isSaveHistory?((0,n.uX)(),(0,n.Wv)(b,{key:1},{default:(0,n.k6)((()=>[(0,n.bF)(f,{onClick:g.requestResetHistory,"aria-label":"clear chat history"},{default:(0,n.k6)((()=>[(0,n.bF)(v,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(p.items[2].icon),1)])),_:1}),(0,n.eW)(" "+(0,i.v_)(p.items[2].title),1)])),_:1},8,["onClick"])])),_:1})):(0,n.Q3)("",!0),g.shouldRenderSfxButton&&g.isSFXOn?((0,n.uX)(),(0,n.Wv)(b,{key:2},{default:(0,n.k6)((()=>[(0,n.bF)(f,{onClick:g.toggleSFXMute,"aria-label":"mute sound effects"},{default:(0,n.k6)((()=>[(0,n.bF)(v,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(p.items[3].icon),1)])),_:1}),(0,n.eW)(" "+(0,i.v_)(p.items[3].title),1)])),_:1},8,["onClick"])])),_:1})):(0,n.Q3)("",!0),g.shouldRenderSfxButton&&!g.isSFXOn?((0,n.uX)(),(0,n.Wv)(b,{key:3},{default:(0,n.k6)((()=>[(0,n.bF)(f,{onClick:g.toggleSFXMute,"aria-label":"unmute sound effects"},{default:(0,n.k6)((()=>[(0,n.bF)(v,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(p.items[4].icon),1)])),_:1}),(0,n.eW)(" "+(0,i.v_)(p.items[4].title),1)])),_:1},8,["onClick"])])),_:1})):(0,n.Q3)("",!0),g.canLiveChat?((0,n.uX)(),(0,n.Wv)(b,{key:4},{default:(0,n.k6)((()=>[(0,n.bF)(f,{onClick:g.requestLiveChat,"aria-label":"request live chat"},{default:(0,n.k6)((()=>[(0,n.bF)(v,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(s.toolbarStartLiveChatIcon),1)])),_:1}),(0,n.eW)(" "+(0,i.v_)(s.toolbarStartLiveChatLabel),1)])),_:1},8,["onClick"])])),_:1})):(0,n.Q3)("",!0),g.isLiveChat?((0,n.uX)(),(0,n.Wv)(b,{key:5},{default:(0,n.k6)((()=>[(0,n.bF)(f,{onClick:g.endLiveChat,"aria-label":"end live chat"},{default:(0,n.k6)((()=>[(0,n.bF)(v,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(s.toolbarEndLiveChatIcon),1)])),_:1}),(0,n.eW)(" "+(0,i.v_)(s.toolbarEndLiveChatLabel),1)])),_:1},8,["onClick"])])),_:1})):(0,n.Q3)("",!0),g.isLocaleSelectable?((0,n.uX)(),(0,n.Wv)(b,{key:6,disabled:g.restrictLocaleChanges},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(g.locales,((e,t)=>((0,n.uX)(),(0,n.Wv)(b,{key:t},{default:(0,n.k6)((()=>[(0,n.bF)(f,{onClick:t=>g.setLocale(e)},{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(e),1)])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1},8,["disabled"])):(0,n.Q3)("",!0)])),_:1})])),_:1})):(0,n.Q3)("",!0),(0,n.Lk)("div",a,[(0,n.bF)(A,{text:"Previous",modelValue:p.prevNav,"onUpdate:modelValue":t[0]||(t[0]=e=>p.prevNav=e),activator:".nav-button-prev","content-class":"tooltip-custom",location:"right"},{activator:(0,n.k6)((({props:e})=>[(0,n.bo)((0,n.bF)(m,(0,n.v6)(e,{size:"small",disabled:g.isLexProcessing,class:"nav-button-prev"},(0,n.Tb)(p.prevNavEventHandlers),{onClick:g.onPrev,"aria-label":"go back to previous message",icon:"arrow_back"}),null,16,["disabled","onClick"]),[[o.vShow,g.hasPrevUtterance&&!s.isUiMinimized&&g.shouldRenderBackButton]])])),_:1},8,["modelValue"])]),(0,n.bo)((0,n.bF)(w,{class:"hidden-xs-and-down toolbar-title",onClick:(0,o.withModifiers)(g.toggleMinimize,["stop"])},{default:(0,n.k6)((()=>[(0,n.Lk)("h2",null,(0,i.v_)(s.toolbarTitle)+" "+(0,i.v_)(s.userName),1)])),_:1},8,["onClick"]),[[o.vShow,!s.isUiMinimized]]),(0,n.bF)(A,{modelValue:p.shouldShowTooltip,"onUpdate:modelValue":t[1]||(t[1]=e=>p.shouldShowTooltip=e),"content-class":"tooltip-custom",activator:".min-max-toggle",location:"left"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",c,(0,i.v_)(g.toolTipMinimize),1)])),_:1},8,["modelValue"]),(0,n.bF)(A,{modelValue:p.shouldShowHelpTooltip,"onUpdate:modelValue":t[2]||(t[2]=e=>p.shouldShowHelpTooltip=e),"content-class":"tooltip-custom",activator:".help-toggle",location:"left"},{default:(0,n.k6)((()=>t[5]||(t[5]=[(0,n.Lk)("span",{id:"help-tooltip"},"help",-1)]))),_:1},8,["modelValue"]),(0,n.bF)(A,{modelValue:p.shouldShowEndLiveChatTooltip,"onUpdate:modelValue":t[3]||(t[3]=e=>p.shouldShowEndLiveChatTooltip=e),"content-class":"tooltip-custom",activator:".end-live-chat-btn",location:"left"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",l,(0,i.v_)(s.toolbarEndLiveChatLabel),1)])),_:1},8,["modelValue"]),(0,n.bF)(A,{modelValue:p.shouldShowMenuTooltip,"onUpdate:modelValue":t[4]||(t[4]=e=>p.shouldShowMenuTooltip=e),"content-class":"tooltip-custom",activator:".menu",location:"right"},{default:(0,n.k6)((()=>t[6]||(t[6]=[(0,n.Lk)("span",{id:"menu-tooltip"},"menu",-1)]))),_:1},8,["modelValue"]),g.isLocaleSelectable?((0,n.uX)(),(0,n.CE)("span",u,(0,i.v_)(g.currentLocale),1)):(0,n.Q3)("",!0),!g.shouldRenderHelpButton||g.isLiveChat||s.isUiMinimized?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(m,(0,n.v6)({key:3,onClick:g.sendHelp},(0,n.Tb)(p.tooltipHelpEventHandlers),{disabled:g.isLexProcessing,icon:"",class:"help-toggle"}),{default:(0,n.k6)((()=>[(0,n.bF)(v,null,{default:(0,n.k6)((()=>t[7]||(t[7]=[(0,n.eW)(" help_outline ")]))),_:1})])),_:1},16,["onClick","disabled"])),g.isLiveChat&&!s.isUiMinimized?((0,n.uX)(),(0,n.Wv)(m,(0,n.v6)({key:4,onClick:g.endLiveChat},(0,n.Tb)(p.tooltipEndLiveChatEventHandlers),{disabled:!g.isLiveChat,icon:"",class:"end-live-chat-btn"}),{default:(0,n.k6)((()=>[(0,n.Lk)("span",d,(0,i.v_)(s.toolbarEndLiveChatLabel),1),(0,n.bF)(v,{class:"call-end"},{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(s.toolbarEndLiveChatIcon),1)])),_:1})])),_:1},16,["onClick","disabled"])):(0,n.Q3)("",!0),e.$store.state.isRunningEmbedded?((0,n.uX)(),(0,n.Wv)(m,(0,n.v6)({key:5,onClick:(0,o.withModifiers)(g.toggleMinimize,["stop"])},(0,n.Tb)(p.tooltipEventHandlers),{class:"min-max-toggle",icon:"","aria-label":s.isUiMinimized?"chat":"minimize chat window toggle"}),{default:(0,n.k6)((()=>[(0,n.bF)(v,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,i.v_)(s.isUiMinimized?"chat":"arrow_drop_down"),1)])),_:1})])),_:1},16,["onClick","aria-label"])):(0,n.Q3)("",!0)])),_:1},8,["color","onClick","density","class"]))}},22857:(e,t,s)=>{var n={"./config.awstest.json":[6370,989],"./config.current.json":[58157,157],"./config.dev-old.json":[14631,631],"./config.dev.json":[73147,147],"./config.prod.json":[55013,13],"./config.test.json":[71592,592]};function i(e){if(!s.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],i=t[0];return s.e(t[1]).then((()=>s.t(i,19)))}i.keys=()=>Object.keys(n),i.id=22857,e.exports=i},57064:e=>{"use strict";e.exports="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU2LjM2LjEwMAAAAAAAAAAAAAAA//OEAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAEAAABIADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV6urq6urq6urq6urq6urq6urq6urq6urq6v////////////////////////////////8AAAAATGF2YzU2LjQxAAAAAAAAAAAAAAAAJAAAAAAAAAAAASDs90hvAAAAAAAAAAAAAAAAAAAA//MUZAAAAAGkAAAAAAAAA0gAAAAATEFN//MUZAMAAAGkAAAAAAAAA0gAAAAARTMu//MUZAYAAAGkAAAAAAAAA0gAAAAAOTku//MUZAkAAAGkAAAAAAAAA0gAAAAANVVV"},91715:e=>{"use strict";e.exports="data:audio/ogg;base64,T2dnUwACAAAAAAAAAAAyzN3NAAAAAGFf2X8BM39GTEFDAQAAAWZMYUMAAAAiEgASAAAAAAAkFQrEQPAAAAAAAAAAAAAAAAAAAAAAAAAAAE9nZ1MAAAAAAAAAAAAAMszdzQEAAAD5LKCSATeEAAAzDQAAAExhdmY1NS40OC4xMDABAAAAGgAAAGVuY29kZXI9TGF2YzU1LjY5LjEwMCBmbGFjT2dnUwAEARIAAAAAAAAyzN3NAgAAAKWVljkCDAD/+GkIAAAdAAABICI="},11976:()=>{},63779:()=>{},77199:()=>{}},t={};function s(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(o.exports,o,o.exports,s),o.loaded=!0,o.exports}s.m=e,(()=>{var e="function"===typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"===typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"===typeof Symbol?Symbol("webpack error"):"__webpack_error__",i=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},o=s=>s.map((s=>{if(null!==s&&"object"===typeof s){if(s[e])return s;if(s.then){var o=[];o.d=0,s.then((e=>{r[t]=e,i(o)}),(e=>{r[n]=e,i(o)}));var r={};return r[e]=e=>e(o),r}}var a={};return a[e]=e=>{},a[t]=s,a}));s.a=(s,r,a)=>{var c;a&&((c=[]).d=-1);var l,u,d,h=new Set,p=s.exports,g=new Promise(((e,t)=>{d=t,u=e}));g[t]=p,g[e]=e=>(c&&e(c),h.forEach(e),g["catch"]((e=>{}))),s.exports=g,r((s=>{var i;l=o(s);var r=()=>l.map((e=>{if(e[n])throw e[n];return e[t]})),a=new Promise((t=>{i=()=>t(r),i.r=0;var s=e=>e!==c&&!h.has(e)&&(h.add(e),e&&!e.d&&(i.r++,e.push(i)));l.map((t=>t[e](s)))}));return i.r?a:r()}),(e=>(e?d(g[n]=e):u(p),i(c)))),c&&c.d<0&&(c.d=0)}})(),(()=>{var e=[];s.O=(t,n,i,o)=>{if(!n){var r=1/0;for(u=0;u<e.length;u++){n=e[u][0],i=e[u][1],o=e[u][2];for(var a=!0,c=0;c<n.length;c++)(!1&o||r>=o)&&Object.keys(s.O).every((e=>s.O[e](n[c])))?n.splice(c--,1):(a=!1,o<r&&(r=o));if(a){e.splice(u--,1);var l=i();void 0!==l&&(t=l)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,i,o]}})(),(()=>{s.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return s.d(t,{a:t}),t}})(),(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;s.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"===typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"===typeof n.then)return n}var o=Object.create(null);s.r(o);var r={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>r[e]=()=>n[e]));return r["default"]=()=>n,s.d(o,r),o}})(),(()=>{s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}})(),(()=>{s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[]))})(),(()=>{s.u=e=>"js/"+e+"."+{13:"4ee90d48",147:"aad63291",157:"e6b7d267",592:"198bf031",631:"62e03a1d",989:"7f5e68b3"}[e]+".js"})(),(()=>{s.miniCssF=e=>{}})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="lex-web-ui:";s.l=(n,i,o,r)=>{if(e[n])e[n].push(i);else{var a,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+o){a=d;break}}a||(c=!0,a=document.createElement("script"),a.charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",t+o),a.src=n),e[n]=[i];var h=(t,s)=>{a.onerror=a.onload=null,clearTimeout(p);var i=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(s))),t)return t(s)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),c&&document.head.appendChild(a)}}})(),(()=>{s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e)})(),(()=>{s.p="/"})(),(()=>{var e={822:0};s.f.j=(t,n)=>{var i=s.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var o=new Promise(((s,n)=>i=e[t]=[s,n]));n.push(i[2]=o);var r=s.p+s.u(t),a=new Error,c=n=>{if(s.o(e,t)&&(i=e[t],0!==i&&(e[t]=void 0),i)){var o=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+r+")",a.name="ChunkLoadError",a.type=o,a.request=r,i[1](a)}};s.l(r,c,"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,n)=>{var i,o,r=n[0],a=n[1],c=n[2],l=0;if(r.some((t=>0!==e[t]))){for(i in a)s.o(a,i)&&(s.m[i]=a[i]);if(c)var u=c(s)}for(t&&t(n);l<r.length;l++)o=r[l],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(u)},n=self["webpackChunklex_web_ui"]=self["webpackChunklex_web_ui"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=s.O(void 0,[504],(()=>s(13504)));n=s.O(n)})();